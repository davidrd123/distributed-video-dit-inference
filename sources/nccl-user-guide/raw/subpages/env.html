<!DOCTYPE html>
<html class="writer-html5" lang="en-US">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Environment Variables &mdash; NCCL 2.29.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=8eabb79f" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=324d1df1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting" href="troubleshooting.html" />
    <link rel="prev" title="NCCL and MPI" href="mpi.html" />
  <script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 

          
          
          <a href="index.html" class="icon icon-home">
            NCCL
          </a>
              <div class="version">
                <a href="https://docs.nvidia.com/deeplearning/sdk/nccl-archived/index.html">2.29</a>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }
    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }
    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }
    .wy-menu-vertical a:active {
      background-color: #76b900
    }
    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }
  </style>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of NCCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using NCCL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/communicators.html">Creating a Communicator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#creating-a-communicator-with-options">Creating a communicator with options</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#creating-a-communicator-using-multiple-nccluniqueids">Creating a communicator using multiple ncclUniqueIds</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#shrinking-a-communicator">Shrinking a communicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#growing-a-communicator">Growing a communicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#creating-more-communicators">Creating more communicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#using-multiple-nccl-communicators-concurrently">Using multiple NCCL communicators concurrently</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#finalizing-a-communicator">Finalizing a communicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#destroying-a-communicator">Destroying a communicator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage/communicators.html#error-handling-and-communicator-abort">Error handling and communicator abort</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/communicators.html#asynchronous-errors-and-error-handling">Asynchronous errors and error handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage/communicators.html#fault-tolerance">Fault Tolerance</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/communicators.html#quality-of-service">Quality of Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/collectives.html">Collective Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#allreduce">AllReduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#broadcast">Broadcast</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#reduce">Reduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#allgather">AllGather</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#reducescatter">ReduceScatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#alltoall">AlltoAll</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#gather">Gather</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/collectives.html#scatter">Scatter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage/data.html">Data Pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/streams.html">CUDA Stream Semantics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/streams.html#mixing-multiple-streams-within-the-same-ncclgroupstart-end-group">Mixing Multiple Streams within the same ncclGroupStart/End() group</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage/groups.html">Group Calls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/groups.html#management-of-multiple-gpus-from-one-thread">Management Of Multiple GPUs From One Thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/groups.html#aggregated-operations-2-2-and-later">Aggregated Operations (2.2 and later)</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/groups.html#group-operation-ordering-semantics">Group Operation Ordering Semantics</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/groups.html#nonblocking-group-operation">Nonblocking Group Operation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage/p2p.html">Point-to-point communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/p2p.html#two-sided-communication">Two-sided communication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#sendrecv">Sendrecv</a></li>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#one-to-all-scatter">One-to-all (scatter)</a></li>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#all-to-one-gather">All-to-one (gather)</a></li>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#all-to-all">All-to-all</a></li>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#neighbor-exchange">Neighbor exchange</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="usage/p2p.html#one-sided-communication">One-sided communication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#putsignal-and-waitsignal">PutSignal and WaitSignal</a></li>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#barrier">Barrier</a></li>
<li class="toctree-l4"><a class="reference internal" href="usage/p2p.html#id1">All-to-all</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage/threadsafety.html">Thread Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/inplace.html">In-place Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/cudagraph.html">Using NCCL with CUDA Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/bufferreg.html">User Buffer Registration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/bufferreg.html#nvlink-sharp-buffer-registration">NVLink Sharp Buffer Registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/bufferreg.html#ib-sharp-buffer-registration">IB Sharp Buffer Registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/bufferreg.html#general-buffer-registration">General Buffer Registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/bufferreg.html#buffer-registration-and-pxn">Buffer Registration and PXN</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/bufferreg.html#memory-allocator">Memory Allocator</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/bufferreg.html#window-registration">Window Registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/bufferreg.html#zero-cta-optimization">Zero-CTA Optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage/deviceapi.html">Device-Initiated Communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#device-api">Device API</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#host-side-setup">Host-Side Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#simple-lsa-kernel">Simple LSA Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#multimem-device-kernel">Multimem Device Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#thread-groups">Thread Groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#teams">Teams</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#host-accessible-device-pointer-functions">Host-Accessible Device Pointer Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage/deviceapi.html#gin-device-kernel">GIN Device Kernel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">NCCL API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/comms.html">Communicator Creation and Management Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclgetlasterror">ncclGetLastError</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclgeterrorstring">ncclGetErrorString</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclgetversion">ncclGetVersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclgetuniqueid">ncclGetUniqueId</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcomminitrank">ncclCommInitRank</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcomminitall">ncclCommInitAll</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcomminitrankconfig">ncclCommInitRankConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcomminitrankscalable">ncclCommInitRankScalable</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommsplit">ncclCommSplit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommshrink">ncclCommShrink</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommgetuniqueid">ncclCommGetUniqueId</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommgrow">ncclCommGrow</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommfinalize">ncclCommFinalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommrevoke">ncclCommRevoke</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommdestroy">ncclCommDestroy</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommabort">ncclCommAbort</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommgetasyncerror">ncclCommGetAsyncError</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommcount">ncclCommCount</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommcudevice">ncclCommCuDevice</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommuserrank">ncclCommUserRank</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommregister">ncclCommRegister</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommderegister">ncclCommDeregister</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommwindowregister">ncclCommWindowRegister</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclcommwindowderegister">ncclCommWindowDeregister</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclmemalloc">ncclMemAlloc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/comms.html#ncclmemfree">ncclMemFree</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/colls.html">Collective Communication Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclallreduce">ncclAllReduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclbroadcast">ncclBroadcast</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclreduce">ncclReduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclallgather">ncclAllGather</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclreducescatter">ncclReduceScatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclalltoall">ncclAlltoAll</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclgather">ncclGather</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/colls.html#ncclscatter">ncclScatter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/group.html">Group Calls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/group.html#ncclgroupstart">ncclGroupStart</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/group.html#ncclgroupend">ncclGroupEnd</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/group.html#ncclgroupsimulateend">ncclGroupSimulateEnd</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/p2p.html">Point To Point Communication Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/p2p.html#two-sided-point-to-point-operations">Two-Sided Point-to-Point Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/p2p.html#ncclsend">ncclSend</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/p2p.html#ncclrecv">ncclRecv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/p2p.html#one-sided-point-to-point-operations-rma">One-Sided Point-to-Point Operations (RMA)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/p2p.html#ncclputsignal">ncclPutSignal</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/p2p.html#ncclsignal">ncclSignal</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/p2p.html#ncclwaitsignal">ncclWaitSignal</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/types.html">Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#ncclcomm-t">ncclComm_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#ncclresult-t">ncclResult_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#nccldatatype-t">ncclDataType_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#ncclredop-t">ncclRedOp_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#ncclscalarresidence-t">ncclScalarResidence_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#ncclconfig-t">ncclConfig_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#ncclsiminfo-t">ncclSimInfo_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/types.html#ncclwindow-t">ncclWindow_t</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/ops.html">User Defined Reduction Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/ops.html#ncclredopcreatepremulsum">ncclRedOpCreatePreMulSum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/ops.html#ncclredopdestroy">ncclRedOpDestroy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/flags.html">NCCL API Supported Flags</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/flags.html#window-registration-flags">Window Registration Flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/flags.html#nccl-communicator-cta-policy-flags">NCCL Communicator CTA Policy Flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/flags.html#communicator-shrink-flags">Communicator Shrink Flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/device.html">Device API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/device.html#host-side-setup">Host-Side Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#nccldevcomm">ncclDevComm</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#nccldevcommcreate">ncclDevCommCreate</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#nccldevcommdestroy">ncclDevCommDestroy</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#nccldevcommrequirements">ncclDevCommRequirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclcommqueryproperties">ncclCommQueryProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclcommproperties-t">ncclCommProperties_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgintype-t">ncclGinType_t</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/device.html#lsa">LSA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#nccllsabarriersession">ncclLsaBarrierSession</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetpeerpointer">ncclGetPeerPointer</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetlsapointer">ncclGetLsaPointer</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetlocalpointer">ncclGetLocalPointer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/device.html#multimem">Multimem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetlsamultimempointer">ncclGetLsaMultimemPointer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/device.html#host-accessible-device-pointer-functions">Host-Accessible Device Pointer Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetlsamultimemdevicepointer">ncclGetLsaMultimemDevicePointer</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetmultimemdevicepointer">ncclGetMultimemDevicePointer</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetlsadevicepointer">ncclGetLsaDevicePointer</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgetpeerdevicepointer">ncclGetPeerDevicePointer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/device.html#gin">GIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclgin">ncclGin</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#signals-and-counters">Signals and Counters</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/device.html#ncclginbarriersession">ncclGinBarrierSession</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nccl1.html">Migrating from NCCL 1 to NCCL 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nccl1.html#initialization">Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="nccl1.html#communication">Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="nccl1.html#counts">Counts</a></li>
<li class="toctree-l2"><a class="reference internal" href="nccl1.html#in-place-usage-for-allgather-and-reducescatter">In-place usage for AllGather and ReduceScatter</a></li>
<li class="toctree-l2"><a class="reference internal" href="nccl1.html#allgather-arguments-order">AllGather arguments order</a></li>
<li class="toctree-l2"><a class="reference internal" href="nccl1.html#datatypes">Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="nccl1.html#error-codes">Error codes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#communicator-creation-and-destruction-examples">Communicator Creation and Destruction Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples.html#example-1-single-process-single-thread-multiple-devices">Example 1: Single Process, Single Thread, Multiple Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#example-2-one-device-per-process-or-thread">Example 2: One Device per Process or Thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#example-3-multiple-devices-per-thread">Example 3: Multiple Devices per Thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#example-4-multiple-communicators-per-device">Example 4: Multiple communicators per device</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#communication-examples">Communication Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples.html#example-1-one-device-per-process-or-thread">Example 1: One Device per Process or Thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples.html#example-2-multiple-devices-per-thread">Example 2: Multiple Devices per Thread</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mpi.html">NCCL and MPI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mpi.html#api">API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi.html#using-multiple-devices-per-process">Using multiple devices per process</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi.html#reducescatter-operation">ReduceScatter operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi.html#send-and-receive-counts">Send and Receive counts</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi.html#other-collectives-and-point-to-point-operations">Other collectives and point-to-point operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi.html#in-place-operations">In-place operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mpi.html#using-nccl-within-an-mpi-program">Using NCCL within an MPI Program</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mpi.html#mpi-progress">MPI Progress</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi.html#inter-gpu-communication-with-cuda-aware-mpi">Inter-GPU Communication with CUDA-aware MPI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Environment Variables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#system-configuration">System configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nccl-socket-ifname">NCCL_SOCKET_IFNAME</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#values-accepted">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-socket-family">NCCL_SOCKET_FAMILY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-socket-retry-cnt">NCCL_SOCKET_RETRY_CNT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-socket-retry-sleep-msec">NCCL_SOCKET_RETRY_SLEEP_MSEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-socket-poll-timeout-msec">NCCL_SOCKET_POLL_TIMEOUT_MSEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-socket-nthreads">NCCL_SOCKET_NTHREADS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-nsocks-perthread">NCCL_NSOCKS_PERTHREAD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-cross-nic">NCCL_CROSS_NIC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-hca">NCCL_IB_HCA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-timeout">NCCL_IB_TIMEOUT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-retry-cnt">NCCL_IB_RETRY_CNT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-gid-index">NCCL_IB_GID_INDEX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-addr-family">NCCL_IB_ADDR_FAMILY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id13">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-addr-range">NCCL_IB_ADDR_RANGE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-roce-version-num">NCCL_IB_ROCE_VERSION_NUM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-sl">NCCL_IB_SL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id16">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-tc">NCCL_IB_TC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id17">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-fifo-tc">NCCL_IB_FIFO_TC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id18">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-return-async-events">NCCL_IB_RETURN_ASYNC_EVENTS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id19">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-oob-net-enable">NCCL_OOB_NET_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-oob-net-ifname">NCCL_OOB_NET_IFNAME</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id21">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-uid-stagger-threshold">NCCL_UID_STAGGER_THRESHOLD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-uid-stagger-rate">NCCL_UID_STAGGER_RATE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id23">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-net">NCCL_NET</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id24">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-net-plugin">NCCL_NET_PLUGIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id25">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-tuner-plugin">NCCL_TUNER_PLUGIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id26">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-profiler-plugin">NCCL_PROFILER_PLUGIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id27">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-env-plugin">NCCL_ENV_PLUGIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id28">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ignore-cpu-affinity">NCCL_IGNORE_CPU_AFFINITY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id29">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-conf-file">NCCL_CONF_FILE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id30">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-debug">NCCL_DEBUG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id32">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-debug-file">NCCL_DEBUG_FILE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id33">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-debug-subsys">NCCL_DEBUG_SUBSYS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id34">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-debug-timestamp-format">NCCL_DEBUG_TIMESTAMP_FORMAT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#value-accepted">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-debug-timestamp-levels">NCCL_DEBUG_TIMESTAMP_LEVELS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id35">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-collnet-enable">NCCL_COLLNET_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id36">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-collnet-node-threshold">NCCL_COLLNET_NODE_THRESHOLD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id37">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-cta-policy">NCCL_CTA_POLICY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id38">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-netdevs-policy">NCCL_NETDEVS_POLICY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id39">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-topo-file">NCCL_TOPO_FILE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id40">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-topo-dump-file">NCCL_TOPO_DUMP_FILE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id41">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-set-thread-name">NCCL_SET_THREAD_NAME</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id42">Value accepted</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#debugging">Debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nccl-p2p-disable">NCCL_P2P_DISABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id43">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-p2p-level">NCCL_P2P_LEVEL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id44">Values accepted</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integer-values-legacy">Integer Values (Legacy)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-p2p-direct-disable">NCCL_P2P_DIRECT_DISABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id45">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-shm-disable">NCCL_SHM_DISABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id46">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-buffsize">NCCL_BUFFSIZE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id47">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-nthreads">NCCL_NTHREADS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id48">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-max-nchannels">NCCL_MAX_NCHANNELS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id49">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-min-nchannels">NCCL_MIN_NCHANNELS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id50">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-checks-disable">NCCL_CHECKS_DISABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id51">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-check-pointers">NCCL_CHECK_POINTERS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id52">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-launch-mode">NCCL_LAUNCH_MODE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id53">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-disable">NCCL_IB_DISABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id54">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-ar-threshold">NCCL_IB_AR_THRESHOLD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id55">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-qps-per-connection">NCCL_IB_QPS_PER_CONNECTION</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id56">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-split-data-on-qps">NCCL_IB_SPLIT_DATA_ON_QPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id57">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-cuda-support">NCCL_IB_CUDA_SUPPORT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id58">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-pci-relaxed-ordering">NCCL_IB_PCI_RELAXED_ORDERING</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id59">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-adaptive-routing">NCCL_IB_ADAPTIVE_ROUTING</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id60">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-ece-enable">NCCL_IB_ECE_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id61">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-mem-sync-domain">NCCL_MEM_SYNC_DOMAIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id62">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-cumem-enable">NCCL_CUMEM_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id63">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-cumem-host-enable">NCCL_CUMEM_HOST_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id64">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-net-gdr-level-formerly-nccl-ib-gdr-level">NCCL_NET_GDR_LEVEL (formerly NCCL_IB_GDR_LEVEL)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id65">Values accepted</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id66">Integer Values (Legacy)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-net-gdr-c2c">NCCL_NET_GDR_C2C</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id67">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-net-gdr-read">NCCL_NET_GDR_READ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id68">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-net-shared-buffers">NCCL_NET_SHARED_BUFFERS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id69">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-net-shared-comms">NCCL_NET_SHARED_COMMS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id70">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-single-ring-threshold">NCCL_SINGLE_RING_THRESHOLD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id71">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ll-threshold">NCCL_LL_THRESHOLD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id72">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-tree-threshold">NCCL_TREE_THRESHOLD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id73">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-algo">NCCL_ALGO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id74">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-proto">NCCL_PROTO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id75">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-nvb-disable">NCCL_NVB_DISABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id76">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-pxn-disable">NCCL_PXN_DISABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id77">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-p2p-pxn-level">NCCL_P2P_PXN_LEVEL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id78">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-pxn-c2c">NCCL_PXN_C2C</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id79">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-runtime-connect">NCCL_RUNTIME_CONNECT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id80">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-graph-register">NCCL_GRAPH_REGISTER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id82">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-local-register">NCCL_LOCAL_REGISTER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id83">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-legacy-cuda-register">NCCL_LEGACY_CUDA_REGISTER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id84">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-win-enable">NCCL_WIN_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id85">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-set-stack-size">NCCL_SET_STACK_SIZE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id86">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-graph-mixing-support">NCCL_GRAPH_MIXING_SUPPORT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id88">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-dmabuf-enable">NCCL_DMABUF_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id89">Value accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-p2p-net-chunksize">NCCL_P2P_NET_CHUNKSIZE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id90">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-p2p-ll-threshold">NCCL_P2P_LL_THRESHOLD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id91">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-alloc-p2p-net-ll-buffers">NCCL_ALLOC_P2P_NET_LL_BUFFERS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id92">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-comm-blocking">NCCL_COMM_BLOCKING</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id93">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-cga-cluster-size">NCCL_CGA_CLUSTER_SIZE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id94">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-max-ctas">NCCL_MAX_CTAS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id95">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-min-ctas">NCCL_MIN_CTAS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id96">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-nvls-enable">NCCL_NVLS_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id97">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ib-merge-nics">NCCL_IB_MERGE_NICS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id98">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-mnnvl-enable">NCCL_MNNVL_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id99">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-mnnvl-uuid">NCCL_MNNVL_UUID</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id100">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-mnnvl-clique-id">NCCL_MNNVL_CLIQUE_ID</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id101">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ras-enable">NCCL_RAS_ENABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id102">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ras-addr">NCCL_RAS_ADDR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id103">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ras-timeout-factor">NCCL_RAS_TIMEOUT_FACTOR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id104">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-launch-order-implicit">NCCL_LAUNCH_ORDER_IMPLICIT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id106">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-launch-race-fatal">NCCL_LAUNCH_RACE_FATAL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id107">Values accepted</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nccl-ipc-use-abstract-socket">NCCL_IPC_USE_ABSTRACT_SOCKET</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id108">Values accepted</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#errors">Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#ras">RAS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting/ras.html">RAS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="troubleshooting/ras.html#principle-of-operation">Principle of Operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="troubleshooting/ras.html#ras-queries">RAS Queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="troubleshooting/ras.html#sample-output">Sample Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="troubleshooting/ras.html#json-output">JSON Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="troubleshooting/ras.html#monitoring-mode">Monitoring Mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#gpu-direct">GPU Direct</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#gpu-to-gpu-communication">GPU-to-GPU communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#gpu-to-nic-communication">GPU-to-NIC communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#pci-access-control-services-acs">PCI Access Control Services (ACS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#topology-detection">Topology detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#memory-issues">Memory issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#shared-memory">Shared memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#stack-size">Stack size</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#unified-memory-uvm">Unified Memory (UVM)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#networking-issues">Networking issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#ip-network-interfaces">IP Network Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#ip-ports">IP Ports</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#infiniband">InfiniBand</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#rdma-over-converged-ethernet-roce">RDMA over Converged Ethernet (RoCE)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NCCL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Environment Variables</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/env.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="environment-variables">
<h1>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this heading"></a></h1>
<p>NCCL has an extensive set of environment variables to tune for specific usage.</p>
<p>Environment variables can also be set statically in /etc/nccl.conf (for an administrator to set system-wide values) or in ${NCCL_CONF_FILE} (since 2.23; see below).
For example, those files could contain :</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">NCCL_DEBUG</span><span class="o">=</span><span class="n">WARN</span>
<span class="n">NCCL_SOCKET_IFNAME</span><span class="o">==</span><span class="n">ens1f0</span>
</pre></div>
</div>
<p>There are two categories of environment variables. Some are needed to make NCCL follow system-specific configuration,
and can be kept in scripts and system configuration.
Other parameters listed in the Debugging section should not be used in production nor retained in scripts, or only
as workaround, and removed as soon as the issue is resolved. Keeping them set may result in sub-optimal behavior,
crashes, or hangs.</p>
<section id="system-configuration">
<h2>System configuration<a class="headerlink" href="#system-configuration" title="Permalink to this heading"></a></h2>
<section id="nccl-socket-ifname">
<span id="id1"></span><h3>NCCL_SOCKET_IFNAME<a class="headerlink" href="#nccl-socket-ifname" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_IFNAME</span></code> variable specifies which IP interfaces to use for communication.</p>
<section id="values-accepted">
<h4>Values accepted<a class="headerlink" href="#values-accepted" title="Permalink to this heading"></a></h4>
<p>Define to a list of prefixes to filter interfaces to be used by NCCL.</p>
<p>Multiple prefixes can be provided, separated by the <code class="docutils literal notranslate"><span class="pre">,</span></code> symbol.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">^</span></code> symbol, NCCL will exclude interfaces starting with any prefix in that list.</p>
<p>To match (or not) an exact interface name, begin the prefix string with the <code class="docutils literal notranslate"><span class="pre">=</span></code> character.</p>
<p>Examples:</p>
<p><code class="docutils literal notranslate"><span class="pre">eth</span></code> : Use all interfaces starting with <code class="docutils literal notranslate"><span class="pre">eth</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">eth0</span></code>, <code class="docutils literal notranslate"><span class="pre">eth1</span></code>, </p>
<p><code class="docutils literal notranslate"><span class="pre">=eth0</span></code> : Use only interface <code class="docutils literal notranslate"><span class="pre">eth0</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">=eth0,eth1</span></code> : Use only interfaces <code class="docutils literal notranslate"><span class="pre">eth0</span></code> and <code class="docutils literal notranslate"><span class="pre">eth1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">^docker</span></code> : Do not use any interface starting with <code class="docutils literal notranslate"><span class="pre">docker</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">^=docker0</span></code> : Do not use interface <code class="docutils literal notranslate"><span class="pre">docker0</span></code>.</p>
<p>Note: By default, the loopback interface (<code class="docutils literal notranslate"><span class="pre">lo</span></code>) and docker interfaces (<code class="docutils literal notranslate"><span class="pre">docker*</span></code>) would not be selected unless there are no other interfaces available. If you prefer to use <code class="docutils literal notranslate"><span class="pre">lo</span></code> or <code class="docutils literal notranslate"><span class="pre">docker*</span></code> over other interfaces, you would need to explicitly select them using <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_IFNAME</span></code>. The default algorithm will also favor interfaces starting with <code class="docutils literal notranslate"><span class="pre">ib</span></code> over others. Setting <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_IFNAME</span></code> will bypass the automatic interface selection algorithm and may use all interfaces matching the manual selection.</p>
</section>
</section>
<section id="nccl-socket-family">
<h3>NCCL_SOCKET_FAMILY<a class="headerlink" href="#nccl-socket-family" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_FAMILY</span></code> variable allows users to force NCCL to use only IPv4 or IPv6 interface.</p>
<section id="id2">
<h4>Values accepted<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<p>Set to <code class="docutils literal notranslate"><span class="pre">AF_INET</span></code> to force the use of IPv4, or <code class="docutils literal notranslate"><span class="pre">AF_INET6</span></code> to force IPv6 usage.</p>
</section>
</section>
<section id="nccl-socket-retry-cnt">
<h3>NCCL_SOCKET_RETRY_CNT<a class="headerlink" href="#nccl-socket-retry-cnt" title="Permalink to this heading"></a></h3>
<p>(since 2.24)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_RETRY_CNT</span></code> variable specifies the number of times NCCL retries to establish a socket connection after an <code class="docutils literal notranslate"><span class="pre">ETIMEDOUT</span></code>, <code class="docutils literal notranslate"><span class="pre">ECONNREFUSED</span></code>, or <code class="docutils literal notranslate"><span class="pre">EHOSTUNREACH</span></code> error.</p>
<section id="id3">
<h4>Values accepted<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<p>The default value is 34, any positive value is valid.</p>
</section>
</section>
<section id="nccl-socket-retry-sleep-msec">
<h3>NCCL_SOCKET_RETRY_SLEEP_MSEC<a class="headerlink" href="#nccl-socket-retry-sleep-msec" title="Permalink to this heading"></a></h3>
<p>(since 2.24)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_RETRY_SLEEP_MSEC</span></code> variable specifies the number of milliseconds NCCL waits before retrying to establish a socket connection after the first <code class="docutils literal notranslate"><span class="pre">ETIMEDOUT</span></code>, <code class="docutils literal notranslate"><span class="pre">ECONNREFUSED</span></code>, or <code class="docutils literal notranslate"><span class="pre">EHOSTUNREACH</span></code> error.
For subsequent errors, the waiting time scales linearly with the error count. The total time will therefore be (N+1) * N/2 * <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_RETRY_SLEEP_MSEC</span></code>, where N is given by <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_RETRY_CNT</span></code>.
With the default values of <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_RETRY_CNT</span></code> and <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_RETRY_SLEEP_MSEC</span></code>, the total retry time will be approx. 60 seconds.</p>
<section id="id4">
<h4>Values accepted<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h4>
<p>The default value is 100 milliseconds, any positive value is valid.</p>
</section>
</section>
<section id="nccl-socket-poll-timeout-msec">
<h3>NCCL_SOCKET_POLL_TIMEOUT_MSEC<a class="headerlink" href="#nccl-socket-poll-timeout-msec" title="Permalink to this heading"></a></h3>
<p>(since 2.28)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_POLL_TIMEOUT_MSEC</span></code> variable specifies a timeout in
milliseconds for a poll which can reduce the CPU usage during
bootstrap. Normally NCCL will retry the operation until it completes.
Polling in between attempts should reduce load on the CPU so that it
can engage in activities that might make the operation able to complete
sooner.</p>
<section id="id5">
<h4>Values accepted<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h4>
<p>Non-negative integer. The old behavior corredponds to 0 (the default).
If 0, it will not poll, but keep trying to progress the socket
operation without pause. If non-zero, it will poll for up that amount
of time before trying to progress the operation again.</p>
</section>
</section>
<section id="nccl-socket-nthreads">
<h3>NCCL_SOCKET_NTHREADS<a class="headerlink" href="#nccl-socket-nthreads" title="Permalink to this heading"></a></h3>
<p>(since 2.4.8)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_NTHREADS</span></code> variable specifies the number of CPU helper threads used per network connection for socket transport. Increasing this value may increase the socket transport performance, at the cost of a higher CPU usage.</p>
<section id="id6">
<h4>Values accepted<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h4>
<p>1 to 16. On AWS, the default value is 2; on Google Cloud instances with the gVNIC network interface, the default value is 4 (since 2.5.6); in other cases, the default value is 1.</p>
<p>For generic 100G networks, this value can be manually set to 4. However, the product of <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_NTHREADS</span></code> and <code class="docutils literal notranslate"><span class="pre">NCCL_NSOCKS_PERTHREAD</span></code> cannot exceed 64. See also <code class="docutils literal notranslate"><span class="pre">NCCL_NSOCKS_PERTHREAD</span></code>.</p>
</section>
</section>
<section id="nccl-nsocks-perthread">
<h3>NCCL_NSOCKS_PERTHREAD<a class="headerlink" href="#nccl-nsocks-perthread" title="Permalink to this heading"></a></h3>
<p>(since 2.4.8)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_NSOCKS_PERTHREAD</span></code> variable specifies the number of sockets opened by each helper thread of the socket transport. In environments where per-socket speed is limited, setting this variable larger than 1 may improve the network performance.</p>
<section id="id7">
<h4>Values accepted<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h4>
<p>On AWS, the default value is 8; in other cases, the default value is 1.</p>
<p>For generic 100G networks, this value can be manually set to 4. However, the product of <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_NTHREADS</span></code> and <code class="docutils literal notranslate"><span class="pre">NCCL_NSOCKS_PERTHREAD</span></code> cannot exceed 64. See also <code class="docutils literal notranslate"><span class="pre">NCCL_SOCKET_NTHREADS</span></code>.</p>
</section>
</section>
<section id="nccl-cross-nic">
<span id="env-nccl-cross-nic"></span><h3>NCCL_CROSS_NIC<a class="headerlink" href="#nccl-cross-nic" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_CROSS_NIC</span></code> variable controls whether NCCL should allow rings/trees to use different NICs,
causing inter-node communication to use different NICs on different nodes.</p>
<p>To maximize inter-node communication performance when using multiple NICs, NCCL tries to use the
same NICs when communicating
between nodes, to allow for a network design where each NIC on a node connects to
a different network switch (network rail), and avoid any risk of traffic flow interference.
The <code class="docutils literal notranslate"><span class="pre">NCCL_CROSS_NIC</span></code> setting is therefore dependent on the network topology, and in particular
on whether the network fabric is rail-optimized or not.</p>
<p>This has no effect on systems with only one NIC.</p>
<section id="id8">
<h4>Values accepted<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h4>
<p>0: Always use the same NIC for the same ring/tree, to avoid crossing network rails. Suited for networks
with per NIC switches (rails), with a slow inter-rail connection. Note that if the communicator does not
contain the same GPUs on each node, NCCL may still need to communicate across NICs.</p>
<p>1: Allow the use of different NICs for the same ring/tree. This is suited for networks where all NICs
from a node are connected to the same switch, hence trying to communicate across the same NICs does not
help avoiding flow collisions.</p>
<p>2: (Default) Try to use the same NIC for the same ring/tree, but still allow for the use of different NICs
if it would result in a better performance.</p>
</section>
</section>
<section id="nccl-ib-hca">
<h3>NCCL_IB_HCA<a class="headerlink" href="#nccl-ib-hca" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_HCA</span></code> variable specifies which Host Channel Adapter (RDMA) interfaces to use for communication.</p>
<section id="id9">
<h4>Values accepted<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h4>
<p>Define to filter IB Verbs interfaces to be used by NCCL. The list is comma-separated; port numbers can be specified using
the <code class="docutils literal notranslate"><span class="pre">:</span></code> symbol. An optional prefix <code class="docutils literal notranslate"><span class="pre">^</span></code> indicates the list is an exclude list. A second optional prefix <code class="docutils literal notranslate"><span class="pre">=</span></code> indicates
that the tokens are exact names, otherwise by default NCCL would treat each token as a prefix.</p>
<p>Examples:</p>
<p><code class="docutils literal notranslate"><span class="pre">mlx5</span></code> : Use all ports of all cards starting with <code class="docutils literal notranslate"><span class="pre">mlx5</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">=mlx5_0:1,mlx5_1:1</span></code> : Use ports 1 of cards <code class="docutils literal notranslate"><span class="pre">mlx5_0</span></code> and <code class="docutils literal notranslate"><span class="pre">mlx5_1</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">^=mlx5_1,mlx5_4</span></code> : Do not use cards <code class="docutils literal notranslate"><span class="pre">mlx5_1</span></code> and <code class="docutils literal notranslate"><span class="pre">mlx5_4</span></code>.</p>
<p>Note: using <code class="docutils literal notranslate"><span class="pre">mlx5_1</span></code> without a preceding <code class="docutils literal notranslate"><span class="pre">=</span></code> will select <code class="docutils literal notranslate"><span class="pre">mlx5_1</span></code> as well as <code class="docutils literal notranslate"><span class="pre">mlx5_10</span></code> to <code class="docutils literal notranslate"><span class="pre">mlx5_19</span></code>, if they exist.
It is therefore always recommended to add the <code class="docutils literal notranslate"><span class="pre">=</span></code> prefix to ensure an exact match.</p>
<p>Note: There is a fixed upper limit of 32 Host Channel Adapter (HCA) devices supported in NCCL.</p>
</section>
</section>
<section id="nccl-ib-timeout">
<h3>NCCL_IB_TIMEOUT<a class="headerlink" href="#nccl-ib-timeout" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_TIMEOUT</span></code> variable controls the InfiniBand Verbs Timeout.</p>
<p>The timeout is computed as 4.096 s * 2 ^ <em>timeout</em>, and the correct value is dependent on the size of the network.
Increasing that value can help on very large networks, for example, if NCCL is failing on a call to <em>ibv_poll_cq</em> with
error 12.</p>
<p>For more information, see section 12.7.34 of the InfiniBand specification Volume 1 (Local Ack Timeout).</p>
<section id="id10">
<h4>Values accepted<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h4>
<p>The default value used by NCCL is 20 (since 2.23; it was 18 since 2.14, and 14 before that).</p>
<p>Values can be 1-31.</p>
<p>Note: Setting a value of 0 or &gt;= 32 will result in an infinite timeout value.</p>
</section>
</section>
<section id="nccl-ib-retry-cnt">
<h3>NCCL_IB_RETRY_CNT<a class="headerlink" href="#nccl-ib-retry-cnt" title="Permalink to this heading"></a></h3>
<p>(since 2.1.15)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_RETRY_CNT</span></code> variable controls the InfiniBand retry count.</p>
<p>For more information, see section 12.7.38 of the InfiniBand specification Volume 1.</p>
<section id="id11">
<h4>Values accepted<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h4>
<p>The default value is 7.</p>
</section>
</section>
<section id="nccl-ib-gid-index">
<h3>NCCL_IB_GID_INDEX<a class="headerlink" href="#nccl-ib-gid-index" title="Permalink to this heading"></a></h3>
<p>(since 2.1.4)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_GID_INDEX</span></code> variable defines the Global ID index used in RoCE mode.
See the InfiniBand <em>show_gids</em> command in order to set this value.</p>
<p>For more information, see the InfiniBand specification Volume 1
or vendor documentation.</p>
<section id="id12">
<h4>Values accepted<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h4>
<p>The default value is -1.</p>
</section>
</section>
<section id="nccl-ib-addr-family">
<h3>NCCL_IB_ADDR_FAMILY<a class="headerlink" href="#nccl-ib-addr-family" title="Permalink to this heading"></a></h3>
<p>(since 2.21)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_ADDR_FAMILY</span></code> variable defines the IP address family associated to
the infiniband GID dynamically selected by NCCL when <code class="docutils literal notranslate"><span class="pre">NCCL_IB_GID_INDEX</span></code> is left
unset.</p>
<section id="id13">
<h4>Values accepted<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h4>
<p>The default value is AF_INET.</p>
</section>
</section>
<section id="nccl-ib-addr-range">
<h3>NCCL_IB_ADDR_RANGE<a class="headerlink" href="#nccl-ib-addr-range" title="Permalink to this heading"></a></h3>
<p>(since 2.21)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_ADDR_RANGE</span></code> variable defines the range of valid GIDs dynamically
selected by NCCL when <code class="docutils literal notranslate"><span class="pre">NCCL_IB_GID_INDEX</span></code> is left unset.</p>
<section id="id14">
<h4>Values accepted<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h4>
<p>By default, ignored if unset.</p>
<p>GID ranges can be defined using the Classless Inter-Domain Routing (CIDR)
format for IPv4 and IPv6 families.</p>
</section>
</section>
<section id="nccl-ib-roce-version-num">
<h3>NCCL_IB_ROCE_VERSION_NUM<a class="headerlink" href="#nccl-ib-roce-version-num" title="Permalink to this heading"></a></h3>
<p>(since 2.21)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_ROCE_VERSION_NUM</span></code> variable defines the RoCE version associated to
the infiniband GID dynamically selected by NCCL when <code class="docutils literal notranslate"><span class="pre">NCCL_IB_GID_INDEX</span></code> is left
unset.</p>
<section id="id15">
<h4>Values accepted<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h4>
<p>The default value is 2.</p>
</section>
</section>
<section id="nccl-ib-sl">
<h3>NCCL_IB_SL<a class="headerlink" href="#nccl-ib-sl" title="Permalink to this heading"></a></h3>
<p>(since 2.1.4)</p>
<p>Defines the InfiniBand Service Level.</p>
<p>For more information, see the InfiniBand specification Volume 1
or vendor documentation.</p>
<section id="id16">
<h4>Values accepted<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h4>
<p>The default value is 0.</p>
</section>
</section>
<section id="nccl-ib-tc">
<h3>NCCL_IB_TC<a class="headerlink" href="#nccl-ib-tc" title="Permalink to this heading"></a></h3>
<p>(since 2.1.15)</p>
<p>Defines the InfiniBand traffic class field.</p>
<p>For more information, see the InfiniBand specification Volume 1
or vendor documentation.</p>
<section id="id17">
<h4>Values accepted<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h4>
<p>The default value is 0.</p>
</section>
</section>
<section id="nccl-ib-fifo-tc">
<h3>NCCL_IB_FIFO_TC<a class="headerlink" href="#nccl-ib-fifo-tc" title="Permalink to this heading"></a></h3>
<p>(since 2.22.3)</p>
<p>Defines the InfiniBand traffic class for control messages.
Control messages are short RDMA write operations which control
credit return, contrary to other RDMA operations transmitting
large segments of data. This setting allows to have those
messages use a high priority, low-latency traffic class and
avoid being delayed by the rest of the traffic.</p>
<section id="id18">
<h4>Values accepted<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h4>
<p>The default value is the traffic class set by NCCL_IB_TC, which defaults to 0 if not set.</p>
</section>
</section>
<section id="nccl-ib-return-async-events">
<h3>NCCL_IB_RETURN_ASYNC_EVENTS<a class="headerlink" href="#nccl-ib-return-async-events" title="Permalink to this heading"></a></h3>
<p>(since 2.23)</p>
<p>IB events are reported to the user as warnings.
If enabled, NCCL will also stop IB communications upon fatal IB asynchronous events.</p>
<section id="id19">
<h4>Values accepted<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h4>
<p>The default value is 1, set to 0 to disable</p>
</section>
</section>
<section id="nccl-oob-net-enable">
<h3>NCCL_OOB_NET_ENABLE<a class="headerlink" href="#nccl-oob-net-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.23)
The variable <code class="docutils literal notranslate"><span class="pre">NCCL_OOB_NET_ENABLE</span></code> enables the use of NCCL net for out-of-band communications.
Enabling the usage of NCCL net will change the implementation of the allgather performed during the communicator initialization.</p>
<section id="id20">
<h4>Values accepted<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h4>
<p>Set the variable to 0 to disable, and to 1 to enable.</p>
</section>
</section>
<section id="nccl-oob-net-ifname">
<h3>NCCL_OOB_NET_IFNAME<a class="headerlink" href="#nccl-oob-net-ifname" title="Permalink to this heading"></a></h3>
<p>(since 2.23)
If NCCL net is enabled for out-of-band communication (see <code class="docutils literal notranslate"><span class="pre">NCCL_OOB_NET_ENABLE</span></code>), the <code class="docutils literal notranslate"><span class="pre">NCCL_OOB_NET_IFNAME</span></code> variable specifies which network interfaces to use.</p>
<section id="id21">
<h4>Values accepted<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h4>
<p>Define to filter interfaces to be used by NCCL for out-of-band communications. The list of accepted interface depends on the network used by NCCL.
The list is comma-separated; port numbers can be specified using the <code class="docutils literal notranslate"><span class="pre">:</span></code> symbol.
An optional prefix <code class="docutils literal notranslate"><span class="pre">^</span></code> indicates the list is an exclude list.
A second optional prefix <code class="docutils literal notranslate"><span class="pre">=</span></code> indicates that the tokens are exact names, otherwise by default NCCL would treat each token as a prefix.
If multiple devices are specified, NCCL will select the first matching device in the list.</p>
<p>Example:</p>
<p><code class="docutils literal notranslate"><span class="pre">NCCL_NET=&quot;IB&quot;</span> <span class="pre">NCCL_OOB_NET_ENABLE=1</span> <span class="pre">NCCL_OOB_NET_IFNAME=&quot;=mlx5_1&quot;</span></code> will use the Infiniband NET, with the interface <code class="docutils literal notranslate"><span class="pre">mlx5_1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">NCCL_NET=&quot;IB&quot;</span> <span class="pre">NCCL_OOB_NET_ENABLE=1</span> <span class="pre">NCCL_OOB_NET_IFNAME=&quot;mlx5_1&quot;</span></code> will use the Infiniband NET, with the first interface found in the list of <code class="docutils literal notranslate"><span class="pre">mlx5_1</span></code>, <code class="docutils literal notranslate"><span class="pre">mlx5_10</span></code>, <code class="docutils literal notranslate"><span class="pre">mlx5_11</span></code>, etc.</p>
<p><code class="docutils literal notranslate"><span class="pre">NCCL_NET=&quot;Socket&quot;</span> <span class="pre">NCCL_OOB_NET_ENABLE=1</span> <span class="pre">NCCL_OOB_NET_IFNAME=&quot;ens1&quot;</span></code> will use the socket NET, with the first interface found in the list of <code class="docutils literal notranslate"><span class="pre">ens1f0</span></code>, <code class="docutils literal notranslate"><span class="pre">ens1f1</span></code>, etc.</p>
</section>
</section>
<section id="nccl-uid-stagger-threshold">
<h3>NCCL_UID_STAGGER_THRESHOLD<a class="headerlink" href="#nccl-uid-stagger-threshold" title="Permalink to this heading"></a></h3>
<p>(since 2.23)
The <code class="docutils literal notranslate"><span class="pre">NCCL_UID_STAGGER_THRESHOLD</span></code> variable is used to trigger staggering of communications between NCCL ranks and the ncclUniqueId in order to avoid overflowing the ncclUniqueId.
If the number of NCCL ranks communicating exceeds the specified threshold, the communications are staggered using the rank value (see NCCL_UID_STAGGER_RATE below).
If the number of NCCL ranks per ncclUniqueId is smaller or equal to the threshold, no staggering is performed.</p>
<p>For example, if we have 128 NCCL ranks, 1 ncclUniqueId, and a threshold at 64, staggering is performed.
However, if 2 ncclUniqueIds are used with 128 NCCL ranks and a threshold at 64, no staggering is done.</p>
<section id="id22">
<h4>Values accepted<a class="headerlink" href="#id22" title="Permalink to this heading"></a></h4>
<p>The value of <code class="docutils literal notranslate"><span class="pre">NCCL_UID_STAGGER_THRESHOLD</span></code> must be a strictly positive integer.
If unspecified, the default value is 256.</p>
</section>
</section>
<section id="nccl-uid-stagger-rate">
<h3>NCCL_UID_STAGGER_RATE<a class="headerlink" href="#nccl-uid-stagger-rate" title="Permalink to this heading"></a></h3>
<p>(since 2.23)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_UID_STAGGER_RATE</span></code> variable is used to define the message rate targeted when staggering the communications between NCCL ranks and the ncclUniqueId.
If staggering is used (see NCCL_UID_STAGGER_THRESHOLD above), the message rate is used to compute the time a given NCCL rank has to wait.</p>
<section id="id23">
<h4>Values accepted<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h4>
<p>The value of <code class="docutils literal notranslate"><span class="pre">NCCL_UID_STAGGER_RATE</span></code> must be a strictly positive integer, expressed in messages/second.
If unspecified, the default value is 7000.</p>
</section>
</section>
<section id="nccl-net">
<h3>NCCL_NET<a class="headerlink" href="#nccl-net" title="Permalink to this heading"></a></h3>
<p>(since 2.10)</p>
<p>Forces NCCL to use a specific network, for example to make sure NCCL uses an external plugin and doesnt automatically fall back on the internal IB or Socket implementation. Setting this environment variable will override the <code class="docutils literal notranslate"><span class="pre">netName</span></code> configuration in all communicators (see <a class="reference internal" href="api/types.html#ncclconfig"><span class="std std-ref">ncclConfig_t</span></a>); if not set (undefined), the network module will be determined by the configuration; if not passing configuration, NCCL will automatically choose the best network module.</p>
<section id="id24">
<h4>Values accepted<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h4>
<p>The value of NCCL_NET has to match exactly the name of the NCCL network used (case-insensitive). Internal network names are IB (generic IB verbs) and Socket (TCP/IP sockets). External network plugins define their own names. Default value is undefined.</p>
</section>
</section>
<section id="nccl-net-plugin">
<h3>NCCL_NET_PLUGIN<a class="headerlink" href="#nccl-net-plugin" title="Permalink to this heading"></a></h3>
<p>(since 2.11)</p>
<dl class="simple">
<dt>Set it to either a suffix string or to a library name to choose among multiple NCCL net plugins. This setting will cause NCCL to look for the net plugin library using the following strategy:</dt><dd><ul class="simple">
<li><p>If NCCL_NET_PLUGIN is set, attempt loading the library with name specified by NCCL_NET_PLUGIN;</p></li>
<li><p>If NCCL_NET_PLUGIN is set and previous failed, attempt loading libnccl-net-&lt;NCCL_NET_PLUGIN&gt;.so;</p></li>
<li><p>If NCCL_NET_PLUGIN is not set, attempt loading libnccl-net.so;</p></li>
<li><p>If no plugin was found (neither user defined nor default), use internal network plugin.</p></li>
</ul>
</dd>
</dl>
<p>For example, setting <code class="docutils literal notranslate"><span class="pre">NCCL_NET_PLUGIN=foo</span></code> will cause NCCL to try load <code class="docutils literal notranslate"><span class="pre">foo</span></code> and, if <code class="docutils literal notranslate"><span class="pre">foo</span></code> cannot be found, <code class="docutils literal notranslate"><span class="pre">libnccl-net-foo.so</span></code> (provided that it exists on the system).</p>
<section id="id25">
<h4>Values accepted<a class="headerlink" href="#id25" title="Permalink to this heading"></a></h4>
<p>Plugin suffix, plugin file name, or none.</p>
</section>
</section>
<section id="nccl-tuner-plugin">
<h3>NCCL_TUNER_PLUGIN<a class="headerlink" href="#nccl-tuner-plugin" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>Set it to either a suffix string or to a library name to choose among multiple NCCL tuner plugins. This setting will cause NCCL to look for the tuner plugin library using the following strategy:</dt><dd><ul class="simple">
<li><p>If NCCL_TUNER_PLUGIN is set, attempt loading the library with name specified by NCCL_TUNER_PLUGIN;</p></li>
<li><p>If NCCL_TUNER_PLUGIN is set and previous failed, attempt loading libnccl-net-&lt;NCCL_TUNER_PLUGIN&gt;.so;</p></li>
<li><p>If NCCL_TUNER_PLUGIN is not set, attempt loading libnccl-tuner.so;</p></li>
<li><p>If no plugin was found look for the tuner symbols in the net plugin (refer to <code class="docutils literal notranslate"><span class="pre">NCCL_NET_PLUGIN</span></code>);</p></li>
<li><p>If no plugin was found (neither through NCCL_TUNER_PLUGIN nor NCCL_NET_PLUGIN), use internal tuner plugin.</p></li>
</ul>
</dd>
</dl>
<p>For example, setting <code class="docutils literal notranslate"><span class="pre">NCCL_TUNER_PLUGIN=foo</span></code> will cause NCCL to try load <code class="docutils literal notranslate"><span class="pre">foo</span></code> and, if <code class="docutils literal notranslate"><span class="pre">foo</span></code> cannot be found, <code class="docutils literal notranslate"><span class="pre">libnccl-tuner-foo.so</span></code> (provided that it exists on the system).</p>
<section id="id26">
<h4>Values accepted<a class="headerlink" href="#id26" title="Permalink to this heading"></a></h4>
<p>Plugin suffix, plugin file name, or none.</p>
</section>
</section>
<section id="nccl-profiler-plugin">
<h3>NCCL_PROFILER_PLUGIN<a class="headerlink" href="#nccl-profiler-plugin" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>Set it to either a suffix string or to a library name to choose among multiple NCCL profiler plugins. This setting will cause NCCL to look for the profiler plugin library using the following strategy:</dt><dd><ul class="simple">
<li><p>If NCCL_PROFILER_PLUGIN is set, attempt loading the library with name specified by NCCL_PROFILER_PLUGIN;</p></li>
<li><p>If NCCL_PROFILER_PLUGIN is set and previous failed, attempt loading libnccl-profiler-&lt;NCCL_PROFILER_PLUGIN&gt;.so;</p></li>
<li><p>If NCCL_PROFILER_PLUGIN is not set, attempt loading libnccl-profiler.so;</p></li>
<li><p>If no plugin was found (neither user defined nor default), do not enable profiling.</p></li>
<li><p>If NCCL_PROFILER_PLUGIN is set to <code class="docutils literal notranslate"><span class="pre">STATIC_PLUGIN</span></code>, the plugin symbols are searched in the program binary.</p></li>
</ul>
</dd>
</dl>
<p>For example, setting <code class="docutils literal notranslate"><span class="pre">NCCL_PROFILER_PLUGIN=foo</span></code> will cause NCCL to try load <code class="docutils literal notranslate"><span class="pre">foo</span></code> and, if <code class="docutils literal notranslate"><span class="pre">foo</span></code> cannot be found, <code class="docutils literal notranslate"><span class="pre">libnccl-profiler-foo.so</span></code> (provided that it exists on the system).</p>
<section id="id27">
<h4>Values accepted<a class="headerlink" href="#id27" title="Permalink to this heading"></a></h4>
<p>Plugin suffix, plugin file name, or none.</p>
</section>
</section>
<section id="nccl-env-plugin">
<h3>NCCL_ENV_PLUGIN<a class="headerlink" href="#nccl-env-plugin" title="Permalink to this heading"></a></h3>
<p>(since 2.28)</p>
<dl class="simple">
<dt>The <code class="docutils literal notranslate"><span class="pre">NCCL_ENV_PLUGIN</span></code> variable can be used to let NCCL load an external environment plugin. Set it to either a library name or a suffix string to choose among multiple NCCL environment plugins. This setting will cause NCCL to look for the environment plugin library using the following strategy:</dt><dd><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">NCCL_ENV_PLUGIN</span></code> is set to a library name, attempt loading that library (e.g.
<code class="docutils literal notranslate"><span class="pre">NCCL_ENV_PLUGIN=/path/to/library/libfoo.so</span></code> will cause NCCL to try load <code class="docutils literal notranslate"><span class="pre">/path/to/library/libfoo.so</span></code>);</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">NCCL_ENV_PLUGIN</span></code> is set to a suffix string, attempt loading <code class="docutils literal notranslate"><span class="pre">libnccl-env-&lt;NCCL_ENV_PLUGIN&gt;.so</span></code> (e.g.
<code class="docutils literal notranslate"><span class="pre">NCCL_ENV_PLUGIN=foo</span></code> will cause NCCL to try load <code class="docutils literal notranslate"><span class="pre">libnccl-env-foo.so</span></code> from the system library path);</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">NCCL_ENV_PLUGIN</span></code> is not set, attempt loading the default <code class="docutils literal notranslate"><span class="pre">libnccl-env.so</span></code> library from the system library path;</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">NCCL_ENV_PLUGIN</span></code> is set to none, explicitly disable the external plugin and use the internal one;</p></li>
<li><p>If no plugin was found (neither user defined nor default) or the variable is set to none, use the internal environment
plugin.</p></li>
</ul>
</dd>
</dl>
<section id="id28">
<h4>Values accepted<a class="headerlink" href="#id28" title="Permalink to this heading"></a></h4>
<p>Plugin library name (e.g., <code class="docutils literal notranslate"><span class="pre">/path/to/library/libfoo.so</span></code>), suffix (e.g., <code class="docutils literal notranslate"><span class="pre">foo</span></code>), or none.</p>
</section>
</section>
<section id="nccl-ignore-cpu-affinity">
<h3>NCCL_IGNORE_CPU_AFFINITY<a class="headerlink" href="#nccl-ignore-cpu-affinity" title="Permalink to this heading"></a></h3>
<p>(since 2.4.6)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IGNORE_CPU_AFFINITY</span></code> variable can be used to cause NCCL to ignore the jobs supplied CPU affinity and instead use the GPU affinity only.</p>
<section id="id29">
<h4>Values accepted<a class="headerlink" href="#id29" title="Permalink to this heading"></a></h4>
<p>The default is 0, set to 1 to cause NCCL to ignore the jobs supplied CPU affinity.</p>
</section>
</section>
<section id="nccl-conf-file">
<h3>NCCL_CONF_FILE<a class="headerlink" href="#nccl-conf-file" title="Permalink to this heading"></a></h3>
<p>(since 2.23)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_CONF_FILE</span></code> variable allows the user to specify a file with the static configuration.
This does not accept the <code class="docutils literal notranslate"><span class="pre">~</span></code> character as part of the path; please convert to a relative or absolute path first.</p>
<section id="id30">
<h4>Values accepted<a class="headerlink" href="#id30" title="Permalink to this heading"></a></h4>
<p>If unset or if the version is prior to 2.23, NCCL uses .nccl.conf in the home directory if available.</p>
</section>
</section>
<section id="nccl-debug">
<span id="id31"></span><h3>NCCL_DEBUG<a class="headerlink" href="#nccl-debug" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG</span></code> variable controls the debug information that is displayed from NCCL. This variable is commonly used for debugging.</p>
<section id="id32">
<h4>Values accepted<a class="headerlink" href="#id32" title="Permalink to this heading"></a></h4>
<p>VERSION - Prints the NCCL version at the start of the program.</p>
<p>WARN - Prints an explicit error message whenever any NCCL call errors out.</p>
<p>INFO - Prints debug information</p>
<p>TRACE - Prints replayable trace information on every call.</p>
</section>
</section>
<section id="nccl-debug-file">
<h3>NCCL_DEBUG_FILE<a class="headerlink" href="#nccl-debug-file" title="Permalink to this heading"></a></h3>
<p>(since 2.2.12)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_FILE</span></code> variable directs the NCCL debug logging output to a file.
The filename format can be set to <em>filename.%h.%p</em> where <em>%h</em> is replaced with the
hostname and <em>%p</em> is replaced with the process PID. This does not accept the <code class="docutils literal notranslate"><span class="pre">~</span></code> character as part of the path, please convert to a relative or absolute path first.</p>
<section id="id33">
<h4>Values accepted<a class="headerlink" href="#id33" title="Permalink to this heading"></a></h4>
<p>The default output file is <em>stdout</em> unless this environment variable is set.
The filename can also be set to <code class="docutils literal notranslate"><span class="pre">/dev/stdout</span></code> or <code class="docutils literal notranslate"><span class="pre">/dev/stderr</span></code> to direct NCCL debug logging
output to those predefined I/O streams. This also has the effect of making the output line buffered.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_FILE</span></code> will cause NCCL to create and overwrite any previous files of that name.</p>
<p>Note: If the filename is not unique across all the job processes, then the output may be lost or corrupted.</p>
</section>
</section>
<section id="nccl-debug-subsys">
<h3>NCCL_DEBUG_SUBSYS<a class="headerlink" href="#nccl-debug-subsys" title="Permalink to this heading"></a></h3>
<p>(since 2.3.4)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_SUBSYS</span></code> variable allows the user to filter the <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG=INFO</span></code> output based on subsystems.
The value should be a comma separated list of the subsystems to include in the NCCL debug log traces.</p>
<p>Prefixing the subsystem name with ^ will disable the logging for that subsystem.</p>
<section id="id34">
<h4>Values accepted<a class="headerlink" href="#id34" title="Permalink to this heading"></a></h4>
<p>The default value is INIT,BOOTSTRAP,ENV.</p>
<p>Supported subsystem names are INIT (stands for initialization), COLL (stands for collectives), P2P (stands for
peer-to-peer), SHM (stands for shared memory), NET (stands for network), GRAPH (stands for topology detection
and graph search), TUNING (stands for algorithm/protocol tuning), ENV (stands for environment settings), ALLOC (stands
for memory allocations), CALL (standard for function calls), PROXY (stands for the proxy thread operations), NVLS
(standard for NVLink SHARP), BOOTSTRAP (stands for early initialization), REG (stands for memory registration), PROFILE
(stands for coarse-grained profiling of initialization), RAS (stands for reliability, availability, and serviceability
subsystem) and ALL (includes every subsystem).</p>
</section>
</section>
<section id="nccl-debug-timestamp-format">
<h3>NCCL_DEBUG_TIMESTAMP_FORMAT<a class="headerlink" href="#nccl-debug-timestamp-format" title="Permalink to this heading"></a></h3>
<p>(since 2.26)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_TIMESTAMP_FORMAT</span></code> variable allows the user to change
the format used when printing debug log messages.</p>
<p>The time is printed as a local
time. This can be changed by setting the <code class="docutils literal notranslate"><span class="pre">TZ</span></code> environment variable. UTC
is available by setting <code class="docutils literal notranslate"><span class="pre">TZ=UTC</span></code>. Valid values for TZ look like:
<code class="docutils literal notranslate"><span class="pre">US/Pacific</span></code>, <code class="docutils literal notranslate"><span class="pre">America/Los_Angeles</span></code>, etc.</p>
<p>Note that the non-call <code class="docutils literal notranslate"><span class="pre">TRACE</span></code> level of logs continues to print the
microseconds since the NCCL debug subsystem was initialized. The
<code class="docutils literal notranslate"><span class="pre">TRACE</span></code> logs can also print the strftime formatted timestamp at the
beginning if so configured (see <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_TIMESTAMP_LEVELS</span></code>).</p>
<p>(since 2.26)
Underscores in the format are rendered as spaces.</p>
<section id="value-accepted">
<h4>Value accepted<a class="headerlink" href="#value-accepted" title="Permalink to this heading"></a></h4>
<p>The value of the environment variable
is passed to strftime, so any valid format will work here. The
default is <code class="docutils literal notranslate"><span class="pre">[%F</span> <span class="pre">%T]</span> </code>, which is <code class="docutils literal notranslate"><span class="pre">[YYYY-MM-DD</span> <span class="pre">HH:MM:SS]</span> </code>. If the
value is set, but empty, then no timestamp will be printed
(<code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_TIMESTAMP_FORMAT=</span></code>).</p>
<p>In addition to conversion specifications supported by strftime, <code class="docutils literal notranslate"><span class="pre">%Xf</span></code>
can be specified, where <code class="docutils literal notranslate"><span class="pre">X</span></code> is a single numerical digit from 1-9.
This will print fractions of a second. The value of <code class="docutils literal notranslate"><span class="pre">X</span></code>
indicates how many digits will be printed. For example, <code class="docutils literal notranslate"><span class="pre">%3f</span></code> will
print milliseconds. The value is zero padded. For example:
<code class="docutils literal notranslate"><span class="pre">[%F</span> <span class="pre">%T.%9f]</span> </code>. (Note that this can only be used once in the format
string.)</p>
</section>
</section>
<section id="nccl-debug-timestamp-levels">
<h3>NCCL_DEBUG_TIMESTAMP_LEVELS<a class="headerlink" href="#nccl-debug-timestamp-levels" title="Permalink to this heading"></a></h3>
<p>(since 2.26)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_TIMESTAMP_LEVELS</span></code> variable allows the user to set
which log lines get a timestamp depending upon the level of the log.</p>
<section id="id35">
<h4>Value accepted<a class="headerlink" href="#id35" title="Permalink to this heading"></a></h4>
<p>The value should be a comma separated list of the levels which should
have the timestamp. Valid levels are: <code class="docutils literal notranslate"><span class="pre">VERSION</span></code>, <code class="docutils literal notranslate"><span class="pre">WARN</span></code>, <code class="docutils literal notranslate"><span class="pre">INFO</span></code>,
<code class="docutils literal notranslate"><span class="pre">ABORT</span></code>, and <code class="docutils literal notranslate"><span class="pre">TRACE</span></code>. In addition, <code class="docutils literal notranslate"><span class="pre">ALL</span></code> can be used to turn it
on for all levels. Setting it to an empty value disables it for all
levels. If the value is prefixed with a caret (<code class="docutils literal notranslate"><span class="pre">^</span></code>) then the listed
levels will NOT log a timestamp, and the rest will.
The default is to enable timestamps for <code class="docutils literal notranslate"><span class="pre">WARN</span></code>, but disable it for
the rest.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_TIMESTAMP_LEVELS=WARN,INFO,TRACE</span></code> will turn
it on for warnings, info logs, and traces. Or,
<code class="docutils literal notranslate"><span class="pre">NCCL_DEBUG_TIMESTAMP_LEVELS=^TRACE</span></code> will turn them on for everything
but traces, which (except call traces) have their own type of timestamp
(microseconds since nccl debug initialization).</p>
</section>
</section>
<section id="nccl-collnet-enable">
<h3>NCCL_COLLNET_ENABLE<a class="headerlink" href="#nccl-collnet-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.6)</p>
<p>Enable the use of the CollNet plugin.</p>
<section id="id36">
<h4>Value accepted<a class="headerlink" href="#id36" title="Permalink to this heading"></a></h4>
<p>Default is 0, define and set to 1 to use the CollNet plugin.</p>
</section>
</section>
<section id="nccl-collnet-node-threshold">
<h3>NCCL_COLLNET_NODE_THRESHOLD<a class="headerlink" href="#nccl-collnet-node-threshold" title="Permalink to this heading"></a></h3>
<p>(since 2.9.9)</p>
<p>A threshold for the number of nodes below which CollNet will not be enabled.</p>
<section id="id37">
<h4>Value accepted<a class="headerlink" href="#id37" title="Permalink to this heading"></a></h4>
<p>Default is 2, define and set to an integer.</p>
</section>
</section>
<section id="nccl-cta-policy">
<h3>NCCL_CTA_POLICY<a class="headerlink" href="#nccl-cta-policy" title="Permalink to this heading"></a></h3>
<p>(since 2.29, legacy values since 2.27)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_CTA_POLICY</span></code> variable allows the user to set the policy for the NCCL communicator.</p>
<section id="id38">
<h4>Value accepted<a class="headerlink" href="#id38" title="Permalink to this heading"></a></h4>
<p>Set to <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>, legacy) to use <code class="docutils literal notranslate"><span class="pre">NCCL_CTA_POLICY_DEFAULT</span></code> policy (default).
Set to <code class="docutils literal notranslate"><span class="pre">EFFICIENCY</span></code> (or <code class="docutils literal notranslate"><span class="pre">1</span></code>, legacy) to use <code class="docutils literal notranslate"><span class="pre">NCCL_CTA_POLICY_EFFICIENCY</span></code> policy.
Set to <code class="docutils literal notranslate"><span class="pre">ZERO</span></code> (or <code class="docutils literal notranslate"><span class="pre">2</span></code>, legacy) to use <code class="docutils literal notranslate"><span class="pre">NCCL_CTA_POLICY_ZERO</span></code> policy.</p>
<p>Set multiple non-legacy policies with the <code class="docutils literal notranslate"><span class="pre">|</span></code> operator.</p>
<p>For more explanation about NCCL policies, please see <a class="reference internal" href="api/flags.html#cta-policy-flags"><span class="std std-ref">NCCL Communicator CTA Policy Flags</span></a>.</p>
</section>
</section>
<section id="nccl-netdevs-policy">
<h3>NCCL_NETDEVS_POLICY<a class="headerlink" href="#nccl-netdevs-policy" title="Permalink to this heading"></a></h3>
<p>(since 2.28)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_NETDEVS_POLICY</span></code> variable allows the user to set the policy for the assignment of network devices to the GPUs.
For each GPU, NCCL detects automatically available network devices, taking into account their network bandwidth and the node topology.</p>
<section id="id39">
<h4>Value accepted<a class="headerlink" href="#id39" title="Permalink to this heading"></a></h4>
<p>If set to <code class="docutils literal notranslate"><span class="pre">AUTO</span></code> (default), NCCL also takes into account the other GPUs in the same communicator in order to assign network devices.
In specific scenarios, this policy might lead to different GPUs from different communicators sharing the same network devices, and therefore impacts performance.</p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">MAX:N</span></code>, NCCL uses up to N of the network devices available to each GPU.
This is intended to be used when device sharing happens with <code class="docutils literal notranslate"><span class="pre">AUTO</span></code> and impacts the performance.</p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">ALL</span></code>, NCCL will use all the available network devices for each GPU, disregarding other GPUs.</p>
</section>
</section>
<section id="nccl-topo-file">
<h3>NCCL_TOPO_FILE<a class="headerlink" href="#nccl-topo-file" title="Permalink to this heading"></a></h3>
<p>(since 2.6)</p>
<p>Path to an XML file to load before detecting the topology. By default, NCCL will load <code class="docutils literal notranslate"><span class="pre">/var/run/nvidia-topologyd/virtualTopology.xml</span></code> if present.</p>
<section id="id40">
<h4>Value accepted<a class="headerlink" href="#id40" title="Permalink to this heading"></a></h4>
<p>A path to an accessible file describing part or all of the topology.</p>
</section>
</section>
<section id="nccl-topo-dump-file">
<h3>NCCL_TOPO_DUMP_FILE<a class="headerlink" href="#nccl-topo-dump-file" title="Permalink to this heading"></a></h3>
<p>(since 2.6)</p>
<p>Path to a file to dump the XML topology to after detection.</p>
<section id="id41">
<h4>Value accepted<a class="headerlink" href="#id41" title="Permalink to this heading"></a></h4>
<p>A path to a file which will be created or overwritten.</p>
</section>
</section>
<section id="nccl-set-thread-name">
<h3>NCCL_SET_THREAD_NAME<a class="headerlink" href="#nccl-set-thread-name" title="Permalink to this heading"></a></h3>
<p>(since 2.12)</p>
<p>Give more meaningful names to NCCL CPU threads to ease debugging and analysis.</p>
<section id="id42">
<h4>Value accepted<a class="headerlink" href="#id42" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default is 0 (disabled).</p>
</section>
</section>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this heading"></a></h2>
<p>These environment variables should be used with caution. New versions of NCCL could work differently and forcing them to a particular value
will prevent NCCL from selecting the best setting automatically. They can therefore cause performance problems in the long term, or even
break some functionality.</p>
<p>They are fine to use for experiments, or to debug a problem, but should generally not be set for production code.</p>
<section id="nccl-p2p-disable">
<h3>NCCL_P2P_DISABLE<a class="headerlink" href="#nccl-p2p-disable" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_P2P_DISABLE</span></code> variable disables the peer to peer (P2P) transport, which uses CUDA direct access between GPUs, using NVLink or PCI.</p>
<section id="id43">
<h4>Values accepted<a class="headerlink" href="#id43" title="Permalink to this heading"></a></h4>
<p>Define and set to 1 to disable direct GPU-to-GPU (P2P) communication.</p>
</section>
</section>
<section id="nccl-p2p-level">
<span id="env-nccl-p2p-level"></span><h3>NCCL_P2P_LEVEL<a class="headerlink" href="#nccl-p2p-level" title="Permalink to this heading"></a></h3>
<p>(since 2.3.4)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_P2P_LEVEL</span></code> variable allows the user to finely control when to use the peer to peer (P2P) transport between GPUs.
The level defines the maximum distance between GPUs where NCCL will use the P2P transport.  A short string representing
the path type should be used to specify the topographical cutoff for using the P2P transport.</p>
<p>If this isnt specified, NCCL will attempt to optimally select a value based on the architecture and environment its run in.</p>
<section id="id44">
<h4>Values accepted<a class="headerlink" href="#id44" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>LOC : Never use P2P (always disabled)</p></li>
<li><p>NVL : Use P2P when GPUs are connected through NVLink</p></li>
<li><p>PIX : Use P2P when GPUs are on the same PCI switch.</p></li>
<li><p>PXB : Use P2P when GPUs are connected through PCI switches (potentially multiple hops).</p></li>
<li><p>PHB : Use P2P when GPUs are on the same NUMA node. Traffic will go through the CPU.</p></li>
<li><p>SYS : Use P2P between NUMA nodes, potentially crossing the SMP interconnect (e.g. QPI/UPI).</p></li>
</ul>
</section>
<section id="integer-values-legacy">
<h4>Integer Values (Legacy)<a class="headerlink" href="#integer-values-legacy" title="Permalink to this heading"></a></h4>
<p>There is also the option to declare <code class="docutils literal notranslate"><span class="pre">NCCL_P2P_LEVEL</span></code> as an integer corresponding to the path type.  These numerical values were kept for retro-compatibility, for those who used numerical values before strings were allowed.</p>
<p>Integer values are discouraged due to breaking changes in path types - the literal values can change over time.  To avoid headaches debugging your configuration, use string identifiers.</p>
<ul class="simple">
<li><p>LOC : 0</p></li>
<li><p>PIX : 1</p></li>
<li><p>PXB : 2</p></li>
<li><p>PHB : 3</p></li>
<li><p>SYS : 4</p></li>
</ul>
<p>Values greater than 4 will be interpreted as SYS.  NVL is not supported using the legacy integer values.</p>
</section>
</section>
<section id="nccl-p2p-direct-disable">
<h3>NCCL_P2P_DIRECT_DISABLE<a class="headerlink" href="#nccl-p2p-direct-disable" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_P2P_DIRECT_DISABLE</span></code> variable forbids NCCL to directly access user buffers through P2P between GPUs of the same process. This is useful when user buffers are allocated with APIs which do not automatically make them accessible to other GPUs managed by the same process and with P2P access.</p>
<section id="id45">
<h4>Values accepted<a class="headerlink" href="#id45" title="Permalink to this heading"></a></h4>
<p>Define and set to 1 to disable direct user buffer access across GPUs.</p>
</section>
</section>
<section id="nccl-shm-disable">
<h3>NCCL_SHM_DISABLE<a class="headerlink" href="#nccl-shm-disable" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SHM_DISABLE</span></code> variable disables the Shared Memory (SHM) transports. SHM is used between devices when peer-to-peer cannot happen, therefore, host memory is used.  NCCL will use the network (i.e. InfiniBand or IP sockets) to communicate between the CPU sockets when SHM is disabled.</p>
<section id="id46">
<h4>Values accepted<a class="headerlink" href="#id46" title="Permalink to this heading"></a></h4>
<p>Define and set to 1 to disable communication through shared memory (SHM).</p>
</section>
</section>
<section id="nccl-buffsize">
<h3>NCCL_BUFFSIZE<a class="headerlink" href="#nccl-buffsize" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_BUFFSIZE</span></code> variable controls the size of the buffer used by NCCL when communicating data between pairs of GPUs.</p>
<p>Use this variable if you encounter memory constraint issues when using NCCL or you think that a different buffer size would improve performance.</p>
<section id="id47">
<h4>Values accepted<a class="headerlink" href="#id47" title="Permalink to this heading"></a></h4>
<p>The default is 4194304 (4 MiB).</p>
<p>Values are integers, in bytes. The recommendation is to use powers of 2. For example,  1024 will give a 1KiB buffer.</p>
</section>
</section>
<section id="nccl-nthreads">
<h3>NCCL_NTHREADS<a class="headerlink" href="#nccl-nthreads" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_NTHREADS</span></code> variable sets the number of CUDA threads per CUDA block. NCCL will launch one CUDA block per communication channel.</p>
<p>Use this variable if you think your GPU clocks are low and you want to increase the number of threads.</p>
<p>You can also use this variable to reduce the number of threads to decrease the GPU workload.</p>
<section id="id48">
<h4>Values accepted<a class="headerlink" href="#id48" title="Permalink to this heading"></a></h4>
<p>The default is 512 for recent generation GPUs, and 256 for some older generations.</p>
<p>The values allowed are 64, 128, 256 and 512.</p>
</section>
</section>
<section id="nccl-max-nchannels">
<h3>NCCL_MAX_NCHANNELS<a class="headerlink" href="#nccl-max-nchannels" title="Permalink to this heading"></a></h3>
<p>(NCCL_MAX_NRINGS since 2.0.5, NCCL_MAX_NCHANNELS since 2.5.0)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_MAX_NCHANNELS</span></code> variable limits the number of channels NCCL can use. Reducing the number of channels also reduces the
number of CUDA blocks used for communication, hence the impact on GPU computing resources.</p>
<p>The old <code class="docutils literal notranslate"><span class="pre">NCCL_MAX_NRINGS</span></code> variable (used until 2.4) still works as an alias in newer versions but is ignored if <code class="docutils literal notranslate"><span class="pre">NCCL_MAX_NCHANNELS</span></code> is set.</p>
<p>This environment variable has been superseded by <code class="docutils literal notranslate"><span class="pre">NCCL_MAX_CTAS</span></code> which can also be set programmatically using <a class="reference internal" href="api/comms.html#ncclcomminitrankconfig"><span class="std std-ref">ncclCommInitRankConfig</span></a>.</p>
<section id="id49">
<h4>Values accepted<a class="headerlink" href="#id49" title="Permalink to this heading"></a></h4>
<p>Any value above or equal to 1.</p>
</section>
</section>
<section id="nccl-min-nchannels">
<h3>NCCL_MIN_NCHANNELS<a class="headerlink" href="#nccl-min-nchannels" title="Permalink to this heading"></a></h3>
<p>(NCCL_MIN_NRINGS since 2.2.0, NCCL_MIN_NCHANNELS since 2.5.0)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_MIN_NCHANNELS</span></code> variable controls the minimum number of channels you want NCCL to use.
Increasing the number of channels also increases the number of
CUDA blocks NCCL uses, which may be useful to improve performance; however, it uses more CUDA compute resources.</p>
<p>This is especially useful when using aggregated collectives on platforms where NCCL would usually only create one channel.</p>
<p>The old <code class="docutils literal notranslate"><span class="pre">NCCL_MIN_NRINGS</span></code> variable (used until 2.4) still works as an alias in newer versions, but is ignored if <code class="docutils literal notranslate"><span class="pre">NCCL_MIN_NCHANNELS</span></code> is set.</p>
<p>This environment variable has been superseded by <code class="docutils literal notranslate"><span class="pre">NCCL_MIN_CTAS</span></code> which can also be set programmatically using <a class="reference internal" href="api/comms.html#ncclcomminitrankconfig"><span class="std std-ref">ncclCommInitRankConfig</span></a>.</p>
<section id="id50">
<h4>Values accepted<a class="headerlink" href="#id50" title="Permalink to this heading"></a></h4>
<p>The default is platform dependent. Set to an integer value, up to 12 (up to 2.2), 16 (2.3 and 2.4) or 32 (2.5 and later).</p>
</section>
</section>
<section id="nccl-checks-disable">
<h3>NCCL_CHECKS_DISABLE<a class="headerlink" href="#nccl-checks-disable" title="Permalink to this heading"></a></h3>
<p>(since 2.0.5, deprecated in 2.2.12)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_CHECKS_DISABLE</span></code> variable can be used to disable argument checks on each collective call.
Checks are useful during development but can increase the latency. They can be disabled to
improve performance in production.</p>
<section id="id51">
<h4>Values accepted<a class="headerlink" href="#id51" title="Permalink to this heading"></a></h4>
<p>The default is 0, set to 1 to disable checks.</p>
</section>
</section>
<section id="nccl-check-pointers">
<h3>NCCL_CHECK_POINTERS<a class="headerlink" href="#nccl-check-pointers" title="Permalink to this heading"></a></h3>
<p>(since 2.2.12)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_CHECK_POINTERS</span></code> variable enables checking of the CUDA memory pointers on each collective call.
Checks are useful during development but can increase the latency.</p>
<section id="id52">
<h4>Values accepted<a class="headerlink" href="#id52" title="Permalink to this heading"></a></h4>
<p>The default is 0, set to 1 to enable checking.</p>
<p>Setting to 1 restores the original behavior of NCCL prior to 2.2.12.</p>
</section>
</section>
<section id="nccl-launch-mode">
<h3>NCCL_LAUNCH_MODE<a class="headerlink" href="#nccl-launch-mode" title="Permalink to this heading"></a></h3>
<p>(since 2.1.0)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_LAUNCH_MODE</span></code> variable controls how NCCL launches CUDA kernels.</p>
<section id="id53">
<h4>Values accepted<a class="headerlink" href="#id53" title="Permalink to this heading"></a></h4>
<p>The default value is PARALLEL.</p>
<p>Setting is to GROUP will use cooperative groups (CUDA 9.0 and later) for processes managing more than one GPU.
This is deprecated in 2.9 and may be removed in future versions.</p>
</section>
</section>
<section id="nccl-ib-disable">
<h3>NCCL_IB_DISABLE<a class="headerlink" href="#nccl-ib-disable" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_DISABLE</span></code> variable prevents the IB/RoCE transport from being used by NCCL. Instead, NCCL will fall back to
using IP sockets.</p>
<section id="id54">
<h4>Values accepted<a class="headerlink" href="#id54" title="Permalink to this heading"></a></h4>
<p>Define and set to 1 to disable the use of InfiniBand Verbs for communication (and force another method, e.g. IP sockets).</p>
</section>
</section>
<section id="nccl-ib-ar-threshold">
<h3>NCCL_IB_AR_THRESHOLD<a class="headerlink" href="#nccl-ib-ar-threshold" title="Permalink to this heading"></a></h3>
<p>(since 2.6)</p>
<p>Threshold above which we send InfiniBand data in a separate message which can
leverage adaptive routing.</p>
<section id="id55">
<h4>Values accepted<a class="headerlink" href="#id55" title="Permalink to this heading"></a></h4>
<p>Size in bytes, the default value is 8192.</p>
<p>Setting it above NCCL_BUFFSIZE will disable the use of adaptive routing completely.</p>
</section>
</section>
<section id="nccl-ib-qps-per-connection">
<h3>NCCL_IB_QPS_PER_CONNECTION<a class="headerlink" href="#nccl-ib-qps-per-connection" title="Permalink to this heading"></a></h3>
<p>(since 2.10)</p>
<p>Number of IB queue pairs to use for each connection between two ranks. This can be useful on multi-level fabrics which need multiple queue pairs to have good routing entropy.
See <code class="docutils literal notranslate"><span class="pre">NCCL_IB_SPLIT_DATA_ON_QPS</span></code> for different ways to split data on multiple QPs, as it can affect performance.</p>
<section id="id56">
<h4>Values accepted<a class="headerlink" href="#id56" title="Permalink to this heading"></a></h4>
<p>Number between 1 and 128, default is 1.</p>
</section>
</section>
<section id="nccl-ib-split-data-on-qps">
<h3>NCCL_IB_SPLIT_DATA_ON_QPS<a class="headerlink" href="#nccl-ib-split-data-on-qps" title="Permalink to this heading"></a></h3>
<p>(since 2.18)</p>
<p>This parameter controls how we use the queue pairs when we create more than one.
Set to 1 (split mode), each message will be split evenly on each queue pair. This may cause a visible latency degradation if many QPs are used.
Set to 0 (round-robin mode), queue pairs will be used in round-robin mode for each message we send. Operations which do not send multiple messages will not use all QPs.</p>
<section id="id57">
<h4>Values accepted<a class="headerlink" href="#id57" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default is 0 (since NCCL 2.20). Setting it to 1 will enable split mode (default in 2.18 and 2.19).</p>
</section>
</section>
<section id="nccl-ib-cuda-support">
<h3>NCCL_IB_CUDA_SUPPORT<a class="headerlink" href="#nccl-ib-cuda-support" title="Permalink to this heading"></a></h3>
<p>(removed in 2.4.0, see NCCL_NET_GDR_LEVEL)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_IB_CUDA_SUPPORT</span></code> variable is used to force or disable the usage of GPU Direct RDMA.
By default, NCCL enables GPU Direct RDMA if the topology permits it. This variable can disable this behavior or force
the usage of GPU Direct RDMA in all cases.</p>
<section id="id58">
<h4>Values accepted<a class="headerlink" href="#id58" title="Permalink to this heading"></a></h4>
<p>Define and set to 0 to disable GPU Direct RDMA.</p>
<p>Define and set to 1 to force the usage of GPU Direct RDMA.</p>
</section>
</section>
<section id="nccl-ib-pci-relaxed-ordering">
<h3>NCCL_IB_PCI_RELAXED_ORDERING<a class="headerlink" href="#nccl-ib-pci-relaxed-ordering" title="Permalink to this heading"></a></h3>
<p>(since 2.12)</p>
<p>Enable the use of Relaxed Ordering for the IB Verbs transport. Relaxed Ordering can greatly help the performance of InfiniBand networks in virtualized environments.</p>
<section id="id59">
<h4>Values accepted<a class="headerlink" href="#id59" title="Permalink to this heading"></a></h4>
<p>Set to 2 to automatically use Relaxed Ordering if available. Set to 1 to force the use of Relaxed Ordering and fail if not available. Set to 0 to disable the use of Relaxed Ordering. Default is 2.</p>
</section>
</section>
<section id="nccl-ib-adaptive-routing">
<h3>NCCL_IB_ADAPTIVE_ROUTING<a class="headerlink" href="#nccl-ib-adaptive-routing" title="Permalink to this heading"></a></h3>
<p>(since 2.16)</p>
<p>Enable the use of Adaptive Routing capable data transfers for the IB Verbs transport. Adaptive routing can improve the performance of communications at scale. A system defined Adaptive Routing enabled SL has to be selected accordingly (cf. <code class="docutils literal notranslate"><span class="pre">NCCL_IB_SL</span></code>).</p>
<section id="id60">
<h4>Values accepted<a class="headerlink" href="#id60" title="Permalink to this heading"></a></h4>
<p>Enabled (1) by default on IB networks. Disabled (0) by default on RoCE networks. Set to 1 to force use of Adaptive Routing capable data transmission.</p>
</section>
</section>
<section id="nccl-ib-ece-enable">
<h3>NCCL_IB_ECE_ENABLE<a class="headerlink" href="#nccl-ib-ece-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.23)</p>
<p>Enable the use of Enhanced Connection Establishment (ECE) on IB/RoCE Verbs networks. ECE can be used to enable advanced networking features such as Congestion Control, Adaptive Routing and Selective Repeat. Note: These parameters are not interpreted or controlled by NCCL and are passed through directly to the HCAs via the ECE mechanism.</p>
<section id="id61">
<h4>Values accepted<a class="headerlink" href="#id61" title="Permalink to this heading"></a></h4>
<p>Enabled (1) by default (since 2.19). Set to 0 to disable use of ECE network capabilities.</p>
<p>Note: Incorrect configuration of the ECE parameters on a system can adversely affect NCCL performance. Administrators should ensure ECE is correctly configured if it is enabled at the system level.</p>
</section>
</section>
<section id="nccl-mem-sync-domain">
<h3>NCCL_MEM_SYNC_DOMAIN<a class="headerlink" href="#nccl-mem-sync-domain" title="Permalink to this heading"></a></h3>
<p>(since 2.16)</p>
<p>Sets the default Memory Sync Domain for NCCL kernels (CUDA 12.0 &amp; sm90 and later). Memory Sync Domains can help eliminate interference between the NCCL kernels and the application compute kernels, when they use different domains.</p>
<section id="id62">
<h4>Values accepted<a class="headerlink" href="#id62" title="Permalink to this heading"></a></h4>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">cudaLaunchMemSyncDomainRemote</span></code> (1). Currently supported values are 0 and 1.</p>
</section>
</section>
<section id="nccl-cumem-enable">
<span id="env-nccl-cumem-enable"></span><h3>NCCL_CUMEM_ENABLE<a class="headerlink" href="#nccl-cumem-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.18)</p>
<p>Use CUDA cuMem* functions to allocate memory in NCCL.</p>
<section id="id63">
<h4>Values accepted<a class="headerlink" href="#id63" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default is 0 in 2.18 (disabled); since 2.19 this feature is auto-enabled by default if the system supports it (NCCL_CUMEM_ENABLE can still be used to override the autodetection).</p>
</section>
</section>
<section id="nccl-cumem-host-enable">
<h3>NCCL_CUMEM_HOST_ENABLE<a class="headerlink" href="#nccl-cumem-host-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.23)</p>
<p>Use CUDA cuMem* functions to allocate host memory in NCCL.  See <a class="reference internal" href="troubleshooting.html#cumem-host-allocations"><span class="std std-ref">Shared memory</span></a> for more information.</p>
<section id="id64">
<h4>Values accepted<a class="headerlink" href="#id64" title="Permalink to this heading"></a></h4>
<p>0 or 1.
Default is 0 in 2.23; since 2.24, default is 1 if CUDA driver &gt;= 12.6, CUDA runtime &gt;= 12.2, and cuMem host allocations are supported.</p>
</section>
</section>
<section id="nccl-net-gdr-level-formerly-nccl-ib-gdr-level">
<h3>NCCL_NET_GDR_LEVEL (formerly NCCL_IB_GDR_LEVEL)<a class="headerlink" href="#nccl-net-gdr-level-formerly-nccl-ib-gdr-level" title="Permalink to this heading"></a></h3>
<p>(since 2.3.4. In 2.4.0, NCCL_IB_GDR_LEVEL was renamed to NCCL_NET_GDR_LEVEL)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_NET_GDR_LEVEL</span></code> variable allows the user to finely control when to use GPU Direct RDMA between a NIC and a GPU.
The level defines the maximum distance between the NIC and the GPU. A string representing the path type should be used to specify the topographical cutoff for GpuDirect.</p>
<p>If this isnt specified, NCCL will attempt to optimally select a value based on the architecture and environment its run in.</p>
<section id="id65">
<h4>Values accepted<a class="headerlink" href="#id65" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>LOC  : Never use GPU Direct RDMA (always disabled).</p></li>
<li><p>PIX  : Use GPU Direct RDMA when GPU and NIC are on the same PCI switch.</p></li>
<li><p>PXB  : Use GPU Direct RDMA when GPU and NIC are connected through PCI switches (potentially multiple hops).</p></li>
<li><p>PHB  : Use GPU Direct RDMA when GPU and NIC are on the same NUMA node. Traffic will go through the CPU.</p></li>
<li><p>SYS  : Use GPU Direct RDMA even across the SMP interconnect between NUMA nodes (e.g., QPI/UPI) (always enabled).</p></li>
</ul>
</section>
<section id="id66">
<h4>Integer Values (Legacy)<a class="headerlink" href="#id66" title="Permalink to this heading"></a></h4>
<p>There is also the option to declare <code class="docutils literal notranslate"><span class="pre">NCCL_NET_GDR_LEVEL</span></code> as an integer corresponding to the path type.  These numerical values were kept for retro-compatibility, for those who used numerical values before strings were allowed.</p>
<p>Integer values are discouraged due to breaking changes in path types - the literal values can change over time.  To avoid headaches debugging your configuration, use string identifiers.</p>
<ul class="simple">
<li><p>LOC : 0</p></li>
<li><p>PIX : 1</p></li>
<li><p>PXB : 2</p></li>
<li><p>PHB : 3</p></li>
<li><p>SYS : 4</p></li>
</ul>
<p>Values greater than 4 will be interpreted as SYS.</p>
</section>
</section>
<section id="nccl-net-gdr-c2c">
<h3>NCCL_NET_GDR_C2C<a class="headerlink" href="#nccl-net-gdr-c2c" title="Permalink to this heading"></a></h3>
<p>(since 2.26)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_NET_GDR_C2C</span></code> variable enables GPU Direct RDMA when sending data via a NIC attached to a CPU (i.e. distance PHB) where the CPU is connected to the GPU via a C2C interconnect. This effectively overrides the <code class="docutils literal notranslate"><span class="pre">NCCL_NET_GDR_LEVEL</span></code> setting for this particular NIC.</p>
<section id="id67">
<h4>Values accepted<a class="headerlink" href="#id67" title="Permalink to this heading"></a></h4>
<p>0 or 1. Define and set to 1 to use GPU Direct RDMA to send data to the NIC directly via C2C connected CPUs.</p>
<p>The default value was 0 in 2.26. The default value is 1 since 2.27.</p>
</section>
</section>
<section id="nccl-net-gdr-read">
<h3>NCCL_NET_GDR_READ<a class="headerlink" href="#nccl-net-gdr-read" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_NET_GDR_READ</span></code> variable enables GPU Direct RDMA when sending data as long as the GPU-NIC distance is within the distance specified by <code class="docutils literal notranslate"><span class="pre">NCCL_NET_GDR_LEVEL</span></code>. Before 2.4.2, GDR read is disabled by default, i.e. when sending data, the data is first stored in CPU memory, then goes to the InfiniBand card. Since 2.4.2, GDR read is enabled by default for NVLink-based platforms.</p>
<p>Note: Reading directly from GPU memory when sending data is known to be slightly slower than reading from CPU memory on some platforms, such as PCI-E.</p>
<section id="id68">
<h4>Values accepted<a class="headerlink" href="#id68" title="Permalink to this heading"></a></h4>
<p>0 or 1. Define and set to 1 to use GPU Direct RDMA to send data to the NIC directly (bypassing CPU).</p>
<p>Before 2.4.2, the default value is 0 for all platforms. Since 2.4.2, the default value is 1 for NVLink-based platforms and 0 otherwise.</p>
</section>
</section>
<section id="nccl-net-shared-buffers">
<h3>NCCL_NET_SHARED_BUFFERS<a class="headerlink" href="#nccl-net-shared-buffers" title="Permalink to this heading"></a></h3>
<p>(since 2.8)</p>
<p>Allows the usage of shared buffers for inter-node point-to-point communication.
This will use a single large pool for all remote peers, having a constant
memory usage instead of increasing linearly with the number of remote peers.</p>
<section id="id69">
<h4>Value accepted<a class="headerlink" href="#id69" title="Permalink to this heading"></a></h4>
<p>Default is 1 (enabled). Set to 0 to disable.</p>
</section>
</section>
<section id="nccl-net-shared-comms">
<h3>NCCL_NET_SHARED_COMMS<a class="headerlink" href="#nccl-net-shared-comms" title="Permalink to this heading"></a></h3>
<p>(since 2.12)</p>
<p>Reuse the same connections in the context of PXN. This allows for message
aggregation but can also decrease the entropy of network packets.</p>
<section id="id70">
<h4>Value accepted<a class="headerlink" href="#id70" title="Permalink to this heading"></a></h4>
<p>Default is 1 (enabled). Set to 0 to disable.</p>
</section>
</section>
<section id="nccl-single-ring-threshold">
<h3>NCCL_SINGLE_RING_THRESHOLD<a class="headerlink" href="#nccl-single-ring-threshold" title="Permalink to this heading"></a></h3>
<p>(since 2.1, removed in 2.3)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_SINGLE_RING_THRESHOLD</span></code> variable sets the limit under which NCCL will only use one ring.
This will limit bandwidth but improve latency.</p>
<section id="id71">
<h4>Values accepted<a class="headerlink" href="#id71" title="Permalink to this heading"></a></h4>
<p>The default value is 262144 (256kB) on GPUs with compute capability 7 and above. Otherwise, the default value is 131072 (128kB).</p>
<p>Values are integers, in bytes.</p>
</section>
</section>
<section id="nccl-ll-threshold">
<h3>NCCL_LL_THRESHOLD<a class="headerlink" href="#nccl-ll-threshold" title="Permalink to this heading"></a></h3>
<p>(since 2.1, removed in 2.5)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_LL_THRESHOLD</span></code> variable sets the size limit under which NCCL uses low-latency algorithms.</p>
<section id="id72">
<h4>Values accepted<a class="headerlink" href="#id72" title="Permalink to this heading"></a></h4>
<p>The default is 16384 (up to 2.2) or is dependent on the number of ranks (2.3 and later).</p>
<p>Values are integers, in bytes.</p>
</section>
</section>
<section id="nccl-tree-threshold">
<h3>NCCL_TREE_THRESHOLD<a class="headerlink" href="#nccl-tree-threshold" title="Permalink to this heading"></a></h3>
<p>(since 2.4, removed in 2.5)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_TREE_THRESHOLD</span></code> variable sets the size limit under which NCCL uses tree algorithms instead of rings.</p>
<section id="id73">
<h4>Values accepted<a class="headerlink" href="#id73" title="Permalink to this heading"></a></h4>
<p>The default is dependent on the number of ranks.</p>
<p>Values are integers, in bytes.</p>
</section>
</section>
<section id="nccl-algo">
<h3>NCCL_ALGO<a class="headerlink" href="#nccl-algo" title="Permalink to this heading"></a></h3>
<p>(since 2.5)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_ALGO</span></code> variable defines which algorithms NCCL will use.</p>
<section id="id74">
<h4>Values accepted<a class="headerlink" href="#id74" title="Permalink to this heading"></a></h4>
<p>(since 2.5)</p>
<p>Comma-separated list of algorithms (not case sensitive) among:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Algorithm</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2.5+</p></td>
<td><p>Ring</p></td>
</tr>
<tr class="row-odd"><td><p>2.5+</p></td>
<td><p>Tree</p></td>
</tr>
<tr class="row-even"><td><p>2.5 to 2.13</p></td>
<td><p>Collnet</p></td>
</tr>
<tr class="row-odd"><td><p>2.14+</p></td>
<td><p>CollnetChain</p></td>
</tr>
<tr class="row-even"><td><p>2.14+</p></td>
<td><p>CollnetDirect</p></td>
</tr>
<tr class="row-odd"><td><p>2.17+</p></td>
<td><p>NVLS</p></td>
</tr>
<tr class="row-even"><td><p>2.18+</p></td>
<td><p>NVLSTree</p></td>
</tr>
<tr class="row-odd"><td><p>2.23+</p></td>
<td><p>PAT</p></td>
</tr>
</tbody>
</table>
<p>NVLS and NVLSTree enable NVLink SHARP offload.</p>
<p>To specify algorithms to exclude (instead of include), start the list with <code class="docutils literal notranslate"><span class="pre">^</span></code>.</p>
<p>(since 2.24)</p>
<p>The accepted values are expanded to allow more flexibility, and parsing will
issue a warning and fail if an unexpected token is found. Also, if <code class="docutils literal notranslate"><span class="pre">ring</span></code>
is not specified as a valid algorithm then it will not implicitly fall back
to <code class="docutils literal notranslate"><span class="pre">ring</span></code> if there is no other valid algorithm for the function. Instead,
it will fail.</p>
<p>The format is now a semicolon-separated list of pairs of function name and
list of algorithms, where the function name is optional for the first entry.
If not present, then it applies to all functions not later listed.
A colon separates the function (when present) and the comma-separated
list of algorithms.
Also, if the first character of the comma-separated list of algorithms
is a caret (<code class="docutils literal notranslate"><span class="pre">^</span></code>), then all the selections are inverted.</p>
<p>For example,
<code class="docutils literal notranslate"><span class="pre">NCCL_ALGO=&quot;ring,collnetdirect;allreduce:tree,collnetdirect;broadcast:ring&quot;</span></code>
Will enable ring and collnetdirect for all functions, then enable tree
and collnetdirect for allreduce and ring for broadcast.</p>
<p>And, <code class="docutils literal notranslate"><span class="pre">NCCL_ALGO=allreduce:^tree</span></code> will allow the default (all algorithms
available) for all the functions except allreduce, which will have all
algorithms available except tree.</p>
<p>The default is unset, which causes NCCL to automatically choose the available
algorithms based on the node topology and architecture.</p>
</section>
</section>
<section id="nccl-proto">
<h3>NCCL_PROTO<a class="headerlink" href="#nccl-proto" title="Permalink to this heading"></a></h3>
<p>(since 2.5)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_PROTO</span></code> variable defines which protocol(s) NCCL will be allowed
to use.</p>
<p>Users are discouraged from setting this variable, with the exception of
disabling a specific protocol in case a bug in NCCL is suspected. In
particular, enabling LL128 on platforms that dont support it can lead
to data corruption.</p>
<section id="id75">
<h4>Values accepted<a class="headerlink" href="#id75" title="Permalink to this heading"></a></h4>
<p>(since 2.5) Comma-separated list of protocols (not case sensitive) among:
<code class="docutils literal notranslate"><span class="pre">LL</span></code>, <code class="docutils literal notranslate"><span class="pre">LL128</span></code>, and <code class="docutils literal notranslate"><span class="pre">Simple</span></code>. To specify protocols to exclude
(instead of to include), start the list with <code class="docutils literal notranslate"><span class="pre">^</span></code>.</p>
<p>The default behavior enables all supported algorithms: equivalent to
<code class="docutils literal notranslate"><span class="pre">LL,LL128,Simple</span></code> on platforms which support LL128, and <code class="docutils literal notranslate"><span class="pre">LL,Simple</span></code>
otherwise.</p>
<p>(since 2.24) The accepted values are expanded to allow more flexibility,
just as decribed for <code class="docutils literal notranslate"><span class="pre">NCCL_ALGO</span></code> above, allowing the user to specify
protocols for each function.</p>
</section>
</section>
<section id="nccl-nvb-disable">
<h3>NCCL_NVB_DISABLE<a class="headerlink" href="#nccl-nvb-disable" title="Permalink to this heading"></a></h3>
<p>(since 2.11)</p>
<p>Disable intra-node communication through NVLink via an intermediate GPU.</p>
<section id="id76">
<h4>Value accepted<a class="headerlink" href="#id76" title="Permalink to this heading"></a></h4>
<p>Default is 0, set to 1 to disable this mechanism.</p>
</section>
</section>
<section id="nccl-pxn-disable">
<h3>NCCL_PXN_DISABLE<a class="headerlink" href="#nccl-pxn-disable" title="Permalink to this heading"></a></h3>
<p>(since 2.12)</p>
<p>Disable inter-node communication using a non-local NIC, using NVLink and
an intermediate GPU.</p>
<section id="id77">
<h4>Value accepted<a class="headerlink" href="#id77" title="Permalink to this heading"></a></h4>
<p>Default is 0, set to 1 to disable this mechanism.</p>
</section>
</section>
<section id="nccl-p2p-pxn-level">
<h3>NCCL_P2P_PXN_LEVEL<a class="headerlink" href="#nccl-p2p-pxn-level" title="Permalink to this heading"></a></h3>
<p>(since 2.12)</p>
<p>Control in which cases PXN is used for send/receive operations.</p>
<section id="id78">
<h4>Value accepted<a class="headerlink" href="#id78" title="Permalink to this heading"></a></h4>
<p>A value of 0 will disable the use of PXN for send/receive. A value of 1 will enable the use of PXN
when the NIC preferred by the destination is not accessible through PCI switches. A value
of 2 (default) will cause PXN to always be used, even if the NIC is connected through PCI switches,
storing data from all GPUs within the node on an intermediate GPU to maximize aggregation.</p>
</section>
</section>
<section id="nccl-pxn-c2c">
<h3>NCCL_PXN_C2C<a class="headerlink" href="#nccl-pxn-c2c" title="Permalink to this heading"></a></h3>
<p>(since 2.27)</p>
<p>Allow NCCL to use the PXN mechanism if the peer GPU is connected through C2C + PCIe to the targeted NIC.</p>
<section id="id79">
<h4>Value accepted<a class="headerlink" href="#id79" title="Permalink to this heading"></a></h4>
<p>Default is 1 (since NCCL 2.28; it was 0 in NCCL 2.27). Set to 1 to enable and to 0 to disable.</p>
</section>
</section>
<section id="nccl-runtime-connect">
<h3>NCCL_RUNTIME_CONNECT<a class="headerlink" href="#nccl-runtime-connect" title="Permalink to this heading"></a></h3>
<p>(since 2.22)</p>
<p>Dynamically connect peers during runtime (e.g., calling <cite>ncclAllreduce()</cite>) instead of init stage.</p>
<section id="id80">
<h4>Value accepted<a class="headerlink" href="#id80" title="Permalink to this heading"></a></h4>
<p>Default is 1, set to 0 to connect peers at init stage.</p>
</section>
</section>
<section id="nccl-graph-register">
<span id="id81"></span><h3>NCCL_GRAPH_REGISTER<a class="headerlink" href="#nccl-graph-register" title="Permalink to this heading"></a></h3>
<p>(since 2.11)</p>
<p>Enable user buffer registration when NCCL calls are captured by CUDA Graphs.</p>
<p>Effective only when:
(i) the CollNet algorithm is being used;
(ii) all GPUs within a node have P2P access to each other;
(iii) there is at most one GPU per process.</p>
<p>User buffer registration may reduce the number of data copies between user buffers and the internal buffers of NCCL.
The user buffers will be automatically de-registered when the CUDA Graphs are destroyed.</p>
<section id="id82">
<h4>Value accepted<a class="headerlink" href="#id82" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default value is 1 (enabled).</p>
</section>
</section>
<section id="nccl-local-register">
<h3>NCCL_LOCAL_REGISTER<a class="headerlink" href="#nccl-local-register" title="Permalink to this heading"></a></h3>
<p>(since 2.19)</p>
<p>Enable user local buffer registration when users explicitly call <em>ncclCommRegister</em>.</p>
<section id="id83">
<h4>Value accepted<a class="headerlink" href="#id83" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default value is 1 (enabled).</p>
</section>
</section>
<section id="nccl-legacy-cuda-register">
<h3>NCCL_LEGACY_CUDA_REGISTER<a class="headerlink" href="#nccl-legacy-cuda-register" title="Permalink to this heading"></a></h3>
<p>(since 2.24)</p>
<p>Cuda buffers allocated through <em>cudaMalloc</em> (and related memory allocators) are legacy
buffers. Registering legacy buffer can cause implicit synchronization, which is unsafe
and can possibly cause a hang for NCCL. NCCL disables legacy buffer registration by
default, and users should move to cuMem-based memory allocators for buffer registration.</p>
<section id="id84">
<h4>Value accepted<a class="headerlink" href="#id84" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default value is 0 (disabled).</p>
</section>
</section>
<section id="nccl-win-enable">
<h3>NCCL_WIN_ENABLE<a class="headerlink" href="#nccl-win-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.27)</p>
<p>Enable window memory registration.</p>
<section id="id85">
<h4>Value accepted<a class="headerlink" href="#id85" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default value is 1 (enabled).</p>
</section>
</section>
<section id="nccl-set-stack-size">
<h3>NCCL_SET_STACK_SIZE<a class="headerlink" href="#nccl-set-stack-size" title="Permalink to this heading"></a></h3>
<p>(since 2.9)</p>
<p>Set CUDA kernel stack size to the maximum stack size amongst all NCCL kernels.</p>
<p>It may avoid a CUDA memory reconfiguration on load. Set to 1 if you experience hang due to CUDA memory reconfiguration.</p>
<section id="id86">
<h4>Value accepted<a class="headerlink" href="#id86" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default value is 0 (disabled).</p>
</section>
</section>
<section id="nccl-graph-mixing-support">
<span id="id87"></span><h3>NCCL_GRAPH_MIXING_SUPPORT<a class="headerlink" href="#nccl-graph-mixing-support" title="Permalink to this heading"></a></h3>
<p>(since 2.13)</p>
<p>Enable/disable support for multiple outstanding NCCL calls from parallel CUDA graphs or a CUDA graph and non-captured NCCL calls. NCCL calls are considered outstanding starting from their host-side launch (e.g., a call to <cite>ncclAllreduce()</cite> for non-captured calls or <cite>cudaGraphLaunch()</cite> for captured calls) and ending when the device kernel execution completes. With graph mixing support disabled, the following use cases are NOT supported:</p>
<ol class="arabic simple">
<li><p>Using a NCCL communicator (or split-shared communicators) from parallel graph launches, where parallel means on different streams without dependencies that would serialize their execution.</p></li>
<li><p>Launching a non-captured NCCL collective during an outstanding graph launch that uses the same communicator (or split-shared communicators), regardless of stream ordering.</p></li>
</ol>
<p>The ability to disable support is motivated by observed hangs in the CUDA launches when support is enabled and multiple ranks have work launched via cudaGraphLaunch from the same thread.</p>
<section id="id88">
<h4>Value accepted<a class="headerlink" href="#id88" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default is 1 (enabled).</p>
</section>
</section>
<section id="nccl-dmabuf-enable">
<h3>NCCL_DMABUF_ENABLE<a class="headerlink" href="#nccl-dmabuf-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.13)</p>
<p>Enable GPU Direct RDMA buffer registration using the Linux dma-buf subsystem.</p>
<p>The Linux dma-buf subsystem allows GPU Direct RDMA capable NICs to read and write CUDA buffers directly without CPU involvement.</p>
<section id="id89">
<h4>Value accepted<a class="headerlink" href="#id89" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default value is 1 (enabled), but the feature is automatically disabled if the Linux kernel or the CUDA/NIC driver do not support it.</p>
</section>
</section>
<section id="nccl-p2p-net-chunksize">
<h3>NCCL_P2P_NET_CHUNKSIZE<a class="headerlink" href="#nccl-p2p-net-chunksize" title="Permalink to this heading"></a></h3>
<p>(since 2.14)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_P2P_NET_CHUNKSIZE</span></code> controls the size of messages sent through the network for ncclSend/ncclRecv operations.</p>
<section id="id90">
<h4>Values accepted<a class="headerlink" href="#id90" title="Permalink to this heading"></a></h4>
<p>The default is 131072 (128 K).</p>
<p>Values are integers, in bytes. The recommendation is to use powers of 2, hence 262144 would be the next value.</p>
</section>
</section>
<section id="nccl-p2p-ll-threshold">
<h3>NCCL_P2P_LL_THRESHOLD<a class="headerlink" href="#nccl-p2p-ll-threshold" title="Permalink to this heading"></a></h3>
<p>(since 2.14)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_P2P_LL_THRESHOLD</span></code> is the maximum message size that NCCL will use the LL protocol for P2P operations.</p>
<section id="id91">
<h4>Values accepted<a class="headerlink" href="#id91" title="Permalink to this heading"></a></h4>
<p>Decimal number. Default is 16384.</p>
</section>
</section>
<section id="nccl-alloc-p2p-net-ll-buffers">
<h3>NCCL_ALLOC_P2P_NET_LL_BUFFERS<a class="headerlink" href="#nccl-alloc-p2p-net-ll-buffers" title="Permalink to this heading"></a></h3>
<p>(since 2.14)</p>
<p><code class="docutils literal notranslate"><span class="pre">NCCL_ALLOC_P2P_NET_LL_BUFFERS</span></code> instructs communicators to allocate dedicated LL buffers for all P2P network connections.  This enables all ranks to use the LL protocol for latency-bound send and receive operations below <code class="docutils literal notranslate"><span class="pre">NCCL_P2P_LL_THRESHOLD</span></code> sizes.
Intranode P2P transfers always have dedicated LL buffers allocated.  If running all-to-all workloads with high numbers of ranks, this will result in a high scaling memory overhead.</p>
<section id="id92">
<h4>Values accepted<a class="headerlink" href="#id92" title="Permalink to this heading"></a></h4>
<p>0 or 1. Default value is 0 (disabled).</p>
</section>
</section>
<section id="nccl-comm-blocking">
<h3>NCCL_COMM_BLOCKING<a class="headerlink" href="#nccl-comm-blocking" title="Permalink to this heading"></a></h3>
<p>(since 2.14)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NCCL_COMM_BLOCKING</span></code> variable controls whether NCCL calls are allowed to block or not. This includes all calls to NCCL, including init/finalize functions, as well as communication functions which may also block due to the lazy initialization of connections for send/receive calls. Setting this environment variable will override the <code class="docutils literal notranslate"><span class="pre">blocking</span></code> configuration in all communicators (see <a class="reference internal" href="api/types.html#ncclconfig"><span class="std std-ref">ncclConfig_t</span></a>); if not set (undefined), communicator behavior will be determined by the configuration; if not passing configuration, communicators are blocking.</p>
<section id="id93">
<h4>Values accepted<a class="headerlink" href="#id93" title="Permalink to this heading"></a></h4>
<p>0 or 1. 1 indicates blocking communicators, and 0 indicates nonblocking communicators. The default value is undefined.</p>
</section>
</section>
<section id="nccl-cga-cluster-size">
<h3>NCCL_CGA_CLUSTER_SIZE<a class="headerlink" href="#nccl-cga-cluster-size" title="Permalink to this heading"></a></h3>
<p>(since 2.16)</p>
<p>Set CUDA Cooperative Group Array (CGA) cluster size. On sm90 and later we have an extra level of hierarchy where we
can group together several blocks within the Grid, called Thread Block Clusters. Setting this to non-zero will cause
NCCL to launch the communication kernels with the Cluster Dimension attribute set accordingly. Setting this environment
variable will override the <code class="docutils literal notranslate"><span class="pre">cgaClusterSize</span></code> configuration in all communicators (see <a class="reference internal" href="api/types.html#ncclconfig"><span class="std std-ref">ncclConfig_t</span></a>); if not set
(undefined), CGA cluster size will be determined by the configuration; if not passing configuration, NCCL will
automatically choose the best value.</p>
<section id="id94">
<h4>Values accepted<a class="headerlink" href="#id94" title="Permalink to this heading"></a></h4>
<p>0 to 8. Default value is undefined.</p>
</section>
</section>
<section id="nccl-max-ctas">
<h3>NCCL_MAX_CTAS<a class="headerlink" href="#nccl-max-ctas" title="Permalink to this heading"></a></h3>
<p>(since 2.17)</p>
<p>Set the maximal number of CTAs the NCCL should use. Setting this environment variable will override the <code class="docutils literal notranslate"><span class="pre">maxCTAs</span></code> configuration in all communicators (see <a class="reference internal" href="api/types.html#ncclconfig"><span class="std std-ref">ncclConfig_t</span></a>); if not set (undefined), maximal CTAs will be determined by the configuration; if not passing configuration, NCCL will automatically choose the best value.</p>
<section id="id95">
<h4>Values accepted<a class="headerlink" href="#id95" title="Permalink to this heading"></a></h4>
<p>Set to a positive integer value up to 64 (32 prior to 2.25). Default value is undefined.</p>
</section>
</section>
<section id="nccl-min-ctas">
<h3>NCCL_MIN_CTAS<a class="headerlink" href="#nccl-min-ctas" title="Permalink to this heading"></a></h3>
<p>(since 2.17)</p>
<p>Set the minimal number of CTAs the NCCL should use. Setting this environment variable will override the <code class="docutils literal notranslate"><span class="pre">minCTAs</span></code> configuration in all communicators (see <a class="reference internal" href="api/types.html#ncclconfig"><span class="std std-ref">ncclConfig_t</span></a>); if not set (undefined), minimal CTAs will be determined by the configuration; if not passing configuration, NCCL will automatically choose the best value.</p>
<section id="id96">
<h4>Values accepted<a class="headerlink" href="#id96" title="Permalink to this heading"></a></h4>
<p>Set to a positive integer value up to 64 (32 prior to 2.25). Default value is undefined.</p>
</section>
</section>
<section id="nccl-nvls-enable">
<span id="env-nccl-nvls-enable"></span><h3>NCCL_NVLS_ENABLE<a class="headerlink" href="#nccl-nvls-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.17)</p>
<p>Enable the use of NVLink SHARP (NVLS). NVLink SHARP is available in third-generation NVSwitch systems (NVLink4) with Hopper and later GPU architectures, allowing collectives such as <code class="docutils literal notranslate"><span class="pre">ncclAllReduce</span></code> to be offloaded to the NVSwitch domain.
The default value is 2.</p>
<section id="id97">
<h4>Values accepted<a class="headerlink" href="#id97" title="Permalink to this heading"></a></h4>
<p>0: Disable the use of NVLink SHARP. No NVLink SHARP resources will be allocated.</p>
<p>1: Enable NVLink SHARP. NCCL initialization will not fail if NVLink SHARP is not supported on a given system, but it will fail if the NVLink SHARP resources cannot be allocated.</p>
<p>2: (Default) Same as 1: not failing if there is no support, but failing if resources could not be allocated. In versions 2.27 and 2.28, NCCL tried to silently fall back on other transports if NVLS resource allocation failed. This, however, could result in a hang if the allocation failed on just some of the ranks, so in 2.29 the behavior reverted to pre-2.27 (i.e., same as 1). Future versions may re-enable the silent fallback if it can be made to work reliably.</p>
</section>
</section>
<section id="nccl-ib-merge-nics">
<h3>NCCL_IB_MERGE_NICS<a class="headerlink" href="#nccl-ib-merge-nics" title="Permalink to this heading"></a></h3>
<p>(since 2.20)</p>
<p>Enable NCCL to combine dual-port IB NICs into a single logical network device. This allows NCCL to more easily aggregate dual-port NIC bandwidth.</p>
<section id="id98">
<h4>Values accepted<a class="headerlink" href="#id98" title="Permalink to this heading"></a></h4>
<p>Default is 1 (enabled), define and set to 0 to disable NIC merging</p>
</section>
</section>
<section id="nccl-mnnvl-enable">
<h3>NCCL_MNNVL_ENABLE<a class="headerlink" href="#nccl-mnnvl-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.21)</p>
<p>Enable NCCL to use Multi-Node NVLink (MNNVL) when available. If the system or driver are not Multi-Node NVLink capable then MNNVL will automatically be disabled. This feature also requires NCCL CUMEM support (<code class="docutils literal notranslate"><span class="pre">NCCL_CUMEM_ENABLE</span></code>) to be enabled.
MNNVL requires a fully configured and operational IMEX domain for all the nodes that form the NVLink domain. See the CUDA documentation for more details on IMEX domains.</p>
<section id="id99">
<h4>Values accepted<a class="headerlink" href="#id99" title="Permalink to this heading"></a></h4>
<p>0: Disable MNNVL support.</p>
<p>1: Enable MNNVL support. NCCL initialization will fail if MNNVL is not supported or cannot be enabled.</p>
<p>2: Automatic detection of MNNVL support. Will <em>not</em> fail if MNNVL is unsupported or if MNNVL resources cannot be allocated.</p>
</section>
</section>
<section id="nccl-mnnvl-uuid">
<h3>NCCL_MNNVL_UUID<a class="headerlink" href="#nccl-mnnvl-uuid" title="Permalink to this heading"></a></h3>
<p>(since 2.25)
Can be used to set the Multi-Node NVLink (MNNVL) UUID to a user defined value. The supplied value will be assigned to both the upper and lower 64-bit words of the 128-bit UUID. Normally the MNNVL UUID is assigned by the Fabric Manager, and it should not need to be overridden.</p>
<section id="id100">
<h4>Values accepted<a class="headerlink" href="#id100" title="Permalink to this heading"></a></h4>
<p>64-bit integer value.</p>
</section>
</section>
<section id="nccl-mnnvl-clique-id">
<h3>NCCL_MNNVL_CLIQUE_ID<a class="headerlink" href="#nccl-mnnvl-clique-id" title="Permalink to this heading"></a></h3>
<p>(since 2.25)
Can be used to set the Multi-Node NVLink (MNNVL) Clique Id to a user defined value. Normally the Clique Id is assigned by the Fabric Manager, but this environment variable can be used to soft partition MNNVL jobs. i.e. NCCL will only treat ranks with the same &lt;UUID,CLIQUE_ID&gt; as being part of the same NVLink domain.</p>
<section id="id101">
<h4>Values accepted<a class="headerlink" href="#id101" title="Permalink to this heading"></a></h4>
<p>32-bit integer value.</p>
</section>
</section>
<section id="nccl-ras-enable">
<span id="env-nccl-ras-enable"></span><h3>NCCL_RAS_ENABLE<a class="headerlink" href="#nccl-ras-enable" title="Permalink to this heading"></a></h3>
<p>(since 2.24)</p>
<p>Enable NCCLs reliability, availability, and serviceability (RAS) subsystem, which can be used to query the health of
NCCL jobs during execution (see <a class="reference internal" href="troubleshooting/ras.html"><span class="doc">RAS</span></a>).</p>
<section id="id102">
<h4>Values accepted<a class="headerlink" href="#id102" title="Permalink to this heading"></a></h4>
<p>Default is 1 (enabled); define and set to 0 to disable RAS.</p>
</section>
</section>
<section id="nccl-ras-addr">
<span id="env-nccl-ras-addr"></span><h3>NCCL_RAS_ADDR<a class="headerlink" href="#nccl-ras-addr" title="Permalink to this heading"></a></h3>
<p>(since 2.24)</p>
<p>Specify the IP address and port number of a socket that the RAS subsystem will listen on for client connections.  RAS
can share this socket between multiple processes but that would not be desirable if multiple independent NCCL jobs share
a single node (and if those jobs belong to different users, the OS will not allow the socket to be shared).  In such
cases, each job should be started with a different value (e.g., <code class="docutils literal notranslate"><span class="pre">localhost:12345</span></code>, <code class="docutils literal notranslate"><span class="pre">localhost:12346</span></code>, etc.).  Since
<code class="docutils literal notranslate"><span class="pre">localhost</span></code> is normally used, only those with access to the nodes where the job is running can connect to the socket.
If desired, the address of an externally accessible network interface can be specified instead, which will make RAS
accessible from other nodes (such as a clusters head node), but that has security implications that should be
considered.</p>
<section id="id103">
<h4>Values accepted<a class="headerlink" href="#id103" title="Permalink to this heading"></a></h4>
<p>Default is <code class="docutils literal notranslate"><span class="pre">localhost:28028</span></code>.  Either a host name or an IP address can be used for the first part; an IPv6 address
needs to be enclosed in square brackets (e.g., <code class="docutils literal notranslate"><span class="pre">[::1]</span></code>).</p>
</section>
</section>
<section id="nccl-ras-timeout-factor">
<h3>NCCL_RAS_TIMEOUT_FACTOR<a class="headerlink" href="#nccl-ras-timeout-factor" title="Permalink to this heading"></a></h3>
<p>(since 2.24)</p>
<p>Specify the multiplier factor to apply to all the timeouts of the RAS subsystem.  RAS relies on multiple timeouts,
ranging from 5 to 60 seconds, to determine the state of the application and to maintain its internal communication, with
complex interdependecies between different timeouts.  This variable can be used to scale up all these timeouts in a
safe, consistent manner, should any of the defaults turn out to be too small; e.g., if the NCCL application is subject
to high-overhead debugging/tracing/etc., which makes its execution less predictable.  If one wants to use the
<code class="docutils literal notranslate"><span class="pre">ncclras</span></code> client in such circumstances, its timeout may need to be increased as well (or disabled).</p>
<section id="id104">
<h4>Values accepted<a class="headerlink" href="#id104" title="Permalink to this heading"></a></h4>
<p>Default is 1; define and set to larger values to increase the timeouts.</p>
</section>
</section>
<section id="nccl-launch-order-implicit">
<span id="id105"></span><h3>NCCL_LAUNCH_ORDER_IMPLICIT<a class="headerlink" href="#nccl-launch-order-implicit" title="Permalink to this heading"></a></h3>
<p>(since 2.26)</p>
<p>Implicitly order NCCL operations from different communicators on the same device using the host program order. This ensures the operations will not deadlock. When the CUDA runtime and driver are 12.3+, overlapped execution is permitted. On older CUDA versions the operations will be serialized.</p>
<section id="id106">
<h4>Values accepted<a class="headerlink" href="#id106" title="Permalink to this heading"></a></h4>
<p>Default is 0 (disabled); set to 1 to enable.</p>
</section>
</section>
<section id="nccl-launch-race-fatal">
<h3>NCCL_LAUNCH_RACE_FATAL<a class="headerlink" href="#nccl-launch-race-fatal" title="Permalink to this heading"></a></h3>
<p>(since 2.26)</p>
<p>Attempt to catch host threads racing to launch to the same device and if so return a fatal error. Such a race would violate the determinacy of the program order relied upon by NCCL_LAUNCH_ORDER_IMPLICIT.</p>
<section id="id107">
<h4>Values accepted<a class="headerlink" href="#id107" title="Permalink to this heading"></a></h4>
<p>Default is 1 (enabled); set to 0 to disable.</p>
</section>
</section>
<section id="nccl-ipc-use-abstract-socket">
<h3>NCCL_IPC_USE_ABSTRACT_SOCKET<a class="headerlink" href="#nccl-ipc-use-abstract-socket" title="Permalink to this heading"></a></h3>
<p>(since 2.29)</p>
<p>Use the Linux Abstract Socket mechanism when creating Unix Domain Sockets (UDS) for intra-node CUDA IPC handle exchange.
This is enabled by default, but having it enabled can prevent intra-node GPU communication when using multiple containers in certain situations (e.g. different network namespaces).</p>
<section id="id108">
<h4>Values accepted<a class="headerlink" href="#id108" title="Permalink to this heading"></a></h4>
<p>Default is 1 (enabled); set to 0 to disable.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mpi.html" class="btn btn-neutral float-left" title="NCCL and MPI" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2025, NVIDIA Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  
  <style>
  a:link, a:visited {
    color: #76b900;
  }
  a:hover {
    color: #8c0;
  }
  .rst-content dl:not(.docutils) dt {
    background: rgba(118, 185, 0, 0.1) !important;
    color: rgba(59,93,0,1) !important;
    border-top: solid 3px rgba(59,93,0,1) !important;
  }
  </style>
  <script type="text/javascript">_satellite.pageBottom();</script>


</body>
</html>